try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="9dec672f-1a1c-43cd-aa98-897602f496b5",e._sentryDebugIdIdentifier="sentry-dbid-9dec672f-1a1c-43cd-aa98-897602f496b5")}catch(e){}{let e="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:{};e.SENTRY_RELEASE={id:"5.13.0"}}(function(e){function t(t){for(var s,n,r=t[0],c=t[1],l=t[2],d=0,u=[];d<r.length;d++)n=r[d],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&u.push(i[n][0]),i[n]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);p&&p(t);while(u.length)u.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],s=!0,n=1;n<a.length;n++){var r=a[n];0!==i[r]&&(s=!1)}s&&(o.splice(t--,1),e=c(c.s=a[0]))}return e}var s={},n={app:0},i={app:0},o=[];function r(e){return c.p+"js/"+({"@aws-crypto/sha256-js":"@aws-crypto/sha256-js",CookiesNotEnabled:"CookiesNotEnabled",DeletedUserConfirmation:"DeletedUserConfirmation",LoginPage:"LoginPage",NotFound:"NotFound","Signup~settings":"Signup~settings",Signup:"Signup","aliases~compose~contacts~mail":"aliases~compose~contacts~mail","compose~contacts~mail":"compose~contacts~mail","compose~settings":"compose~settings",compose:"compose","aliases~contacts~expired~mail~settings":"aliases~contacts~expired~mail~settings",aliases:"aliases",contacts:"contacts","mail~settings":"mail~settings",mail:"mail",settings:"settings",expired:"expired",icon:"icon",recovery:"recovery",tutorials:"tutorials","qr-code":"qr-code"}[e]||e)+"."+{"@aws-crypto/sha256-js":"3817c5e3",CookiesNotEnabled:"4cfcbfbb",DeletedUserConfirmation:"779bddc7",LoginPage:"8ef47ed8",NotFound:"30c00d6d","Signup~settings":"5f52f346",Signup:"d84563a9","aliases~compose~contacts~mail":"3d86c680","compose~contacts~mail":"34f01bcd","compose~settings":"47238144",compose:"af67d98f","aliases~contacts~expired~mail~settings":"62eb8329",aliases:"48eded22",contacts:"377e7f10","mail~settings":"84cd4009",mail:"f8d6388c",settings:"6e621e2d",expired:"2c7b3a1e",icon:"3fb427c3",recovery:"d3775b06",tutorials:"f4abd7e5","qr-code":"ddd50f44"}[e]+".js"}function c(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.e=function(e){var t=[],a={CookiesNotEnabled:1,DeletedUserConfirmation:1,LoginPage:1,NotFound:1,"Signup~settings":1,Signup:1,"aliases~compose~contacts~mail":1,"compose~contacts~mail":1,"compose~settings":1,compose:1,"aliases~contacts~expired~mail~settings":1,aliases:1,contacts:1,"mail~settings":1,mail:1,settings:1,expired:1,recovery:1,tutorials:1};n[e]?t.push(n[e]):0!==n[e]&&a[e]&&t.push(n[e]=new Promise((function(t,a){for(var s="css/"+({"@aws-crypto/sha256-js":"@aws-crypto/sha256-js",CookiesNotEnabled:"CookiesNotEnabled",DeletedUserConfirmation:"DeletedUserConfirmation",LoginPage:"LoginPage",NotFound:"NotFound","Signup~settings":"Signup~settings",Signup:"Signup","aliases~compose~contacts~mail":"aliases~compose~contacts~mail","compose~contacts~mail":"compose~contacts~mail","compose~settings":"compose~settings",compose:"compose","aliases~contacts~expired~mail~settings":"aliases~contacts~expired~mail~settings",aliases:"aliases",contacts:"contacts","mail~settings":"mail~settings",mail:"mail",settings:"settings",expired:"expired",icon:"icon",recovery:"recovery",tutorials:"tutorials","qr-code":"qr-code"}[e]||e)+"."+{"@aws-crypto/sha256-js":"31d6cfe0",CookiesNotEnabled:"6d47eead",DeletedUserConfirmation:"e73f6af5",LoginPage:"d4678eb0",NotFound:"756525b5","Signup~settings":"794902f8",Signup:"0d872fb3","aliases~compose~contacts~mail":"ec053d2e","compose~contacts~mail":"fef0006c","compose~settings":"f01314f8",compose:"75a652ac","aliases~contacts~expired~mail~settings":"a7917eac",aliases:"79ea5e2d",contacts:"6905e03a","mail~settings":"68c12768",mail:"3c39b32c",settings:"5738d0da",expired:"91014932",icon:"31d6cfe0",recovery:"df1de5a5",tutorials:"1374f9fe","qr-code":"31d6cfe0"}[e]+".css",i=c.p+s,o=document.getElementsByTagName("link"),r=0;r<o.length;r++){var l=o[r],d=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(d===s||d===i))return t()}var u=document.getElementsByTagName("style");for(r=0;r<u.length;r++){l=u[r],d=l.getAttribute("data-href");if(d===s||d===i)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var s=t&&t.target&&t.target.src||i,o=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=s,delete n[e],p.parentNode.removeChild(p),a(o)},p.href=i;var m=document.getElementsByTagName("head")[0];m.appendChild(p)})).then((function(){n[e]=0})));var s=i[e];if(0!==s)if(s)t.push(s[2]);else{var o=new Promise((function(t,a){s=i[e]=[t,a]}));t.push(s[2]=o);var l,d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=r(e);var u=new Error;l=function(t){d.onerror=d.onload=null,clearTimeout(p);var a=i[e];if(0!==a){if(a){var s=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+s+": "+n+")",u.name="ChunkLoadError",u.type=s,u.request=n,a[1](u)}i[e]=void 0}};var p=setTimeout((function(){l({type:"timeout",target:d})}),12e4);d.onerror=d.onload=l,document.head.appendChild(d)}return Promise.all(t)},c.m=e,c.c=s,c.d=function(e,t,a){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)c.d(a,s,function(t){return e[t]}.bind(null,s));return a},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],d=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var p=d;o.push([0,"chunk-vendors","chunk-common"]),a()})({0:function(e,t,a){e.exports=a("cd49")},"10e2":function(e,t,a){},1376:function(e,t,a){"use strict";a("8f2e")},"20fc":function(e,t,a){e.exports=a.p+"img/general-error.c83d5de0.svg"},3651:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));a("13d5");function s(e,t,a,s){if(!t.length)return s?[a]:[];const n=e.reduce((e,t,a)=>(e.set(JSON.stringify(t),a),e),new Map),i=n.get(JSON.stringify(a)),o=t[t.length-1],r=n.get(JSON.stringify(o)),c=Math.min(r,i),l=Math.max(r,i);return!s&&(i<t[0]||i>t.length-1)?[...t]:[...t.filter(e=>n.get(JSON.stringify(e))<c),...s?e.slice(c,l+1):[],...t.filter(e=>n.get(JSON.stringify(e))>l)]}},"3abd":function(e,t,a){"use strict";var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("Modal",e._b({ref:"modal",attrs:{"has-header":!1,"dialog-class":"welcome","modal-is-open":e.isOpen,narrow:""},on:{modalToggled:e.emitToggleEvent},scopedSlots:e._u([{key:"content",fn:function(){return[t("div",{staticClass:"welcome__img"},[e._t("image")],2),t("div",{staticClass:"welcome__content"},[t("h4",{staticClass:"spacing-bottom"},[e._t("header")],2),e._t("content")],2)]},proxy:!0}],null,!0)},"Modal",e.$attrs,!1))},n=[],i=a("2b0e"),o=a("714b"),r=i["a"].extend({name:"QueryModal",components:{Modal:o["a"]},props:{initializeOpen:{type:Boolean,default:!0}},data(){return{isOpen:this.initializeOpen}},methods:{closeModal(){this.$refs.modal.toggleModal()},openModal(){this.$refs.modal.toggleModal()},emitToggleEvent(e){this.$emit("modalToggled",e)}}}),c=r,l=(a("9e4d"),a("2877")),d=Object(l["a"])(c,s,n,!1,null,null,null);t["a"]=d.exports},"52cf":function(e,t,a){e.exports=a.p+"img/highfive.848e6edb.svg"},"53a2":function(e,t,a){"use strict";var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("QueryModal",e._g({ref:"queryModal",attrs:{"initialize-open":!1},scopedSlots:e._u([{key:"image",fn:function(){return[t("img",{attrs:{src:a("52cf"),alt:"highfive"}})]},proxy:!0},{key:"header",fn:function(){return[t("translate",[e._v("High five! You did it!")])]},proxy:!0},{key:"content",fn:function(){return[t("p",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"spacing-bottom"},[e._v(" You've completed your account set up. The Set up guide will automatically close. ")]),t("button",{staticClass:"button button--primary",attrs:{type:"button"},on:{click:e.modalClosedCallback}},[e._v(" "+e._s(e.gotItButtonText)+" ")])]},proxy:!0}])},e.$listeners))},n=[],i=a("2b0e"),o=a("79f6"),r=a("2f62"),c=a("3abd"),l=i["a"].extend({name:"SetupGuideCompletedModal",components:{QueryModal:c["a"]},methods:{...Object(r["b"])("authentication",["updatePreferences"]),modalClosedCallback(){this.$refs.queryModal.closeModal()},modalToggled(e){e||(this.updatePreferences({update:{setup_guide_completed_seen:!0}}),setTimeout(()=>{this.updatePreferences({update:{setup_guide_visible:!1}})},2e3))},openModal(){this.$refs.queryModal.openModal(),o["c"].uiEvents.create({event_type:"setup_guide_completed_modal_shown"})}},computed:{gotItButtonText(){return this.$gettext("Got it")}}}),d=l,u=a("2877"),p=Object(u["a"])(d,s,n,!1,null,null,null);t["a"]=p.exports},5488:function(e,t,a){"use strict";var s=a("2b0e");t["a"]=s["a"].extend({methods:{getFolderName(e){if(!e)return"";if(!e.parent_id)switch(e.type){case"inbox":return this.$gettext("Inbox");case"flagged":return this.$gettext("Flagged");case"drafts":return this.$gettext("Drafts");case"sent":return this.$gettext("Sent");case"trash":return this.$gettext("Trash");case"junk":return this.$gettext("Spam")}return e.display_name},getIcon(e){if(!e.parent_id)switch(e.type){case"inbox":return"inbox";case"flagged":return"flag";case"archive":return"archive";case"drafts":return"draft";case"sent":return"send";case"trash":return"trash";case"junk":return"spam"}return"folder"},isRootFolder(e){return null===e.parent_id}}})},"5f4c":function(e,t,a){"use strict";a("faac")},"602e":function(e,t,a){e.exports=a.p+"img/general-error-mobile.f2d0402a.svg"},"610e":function(e,t,a){},"6b81":function(e,t,a){e.exports=a.p+"img/treasure-chest.0f3d38c5.svg"},"6ba6":function(e,t,a){},"70f8":function(e,t,a){"use strict";a("610e")},"8d8d":function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return n}));const s="MAIL:MESSAGES:SET_SELECTED_MESSAGES",n="MAIL:MESSAGES:SET_ACTIVE_MESSAGE",i="MAIL:MESSAGES:SET_ACTIVE_MESSAGES_IDS",o="MAIL:MESSAGES:SET_LOADING_MESSAGES",r={activeMessageId:null,selectedMessagesIds:[],activeMessagesIds:[],loadingMessages:!1},c={activeMessageId:e=>e.activeMessageId,activeMessage:(e,t)=>t.messageById(e.activeMessageId),activeMessageIndex:e=>e.activeMessagesIds.findIndex(t=>t===e.activeMessageId),activeMessagesCount:e=>e.activeMessagesIds.length,nextMessageId:(e,t)=>e.activeMessagesIds[t.activeMessageIndex+1],previousMessageId:(e,t)=>e.activeMessagesIds[t.activeMessageIndex-1],selectedMessages:(e,t)=>e.selectedMessagesIds.map(t.messageById),selectedMessagesLength:e=>e.selectedMessagesIds.length,loadingMessages:e=>e.loadingMessages},l={clearActiveMessage({commit:e}){e(n,{id:null})},setActiveMessages({commit:e,state:t},{ids:a}){const n=t.selectedMessagesIds.filter(e=>a.includes(e));n.length!==t.selectedMessagesIds.length&&e(s,{ids:n}),e(i,{ids:a})},selectMessage({commit:e,state:t},{id:a}){t.activeMessagesIds.includes(a)&&!t.selectedMessagesIds.includes(a)&&e(s,{ids:[...t.selectedMessagesIds,a]})},deselectMessage({commit:e,state:t},{id:a}){e(s,{ids:t.selectedMessagesIds.filter(e=>e!==a)})},setMessageSelection({commit:e,state:t},{ids:a}){e(s,{ids:a.filter(e=>t.activeMessagesIds.includes(e))})},deselectAllMessages({commit:e}){e(s,{ids:[]})},selectAllMessages({commit:e,state:t}){e(s,{ids:t.activeMessagesIds})},setLoadingMessages({commit:e},t){e(o,{loadingMessages:t})}},d={[n](e,{id:t}){e.activeMessageId=t},[i](e,{ids:t}){e.activeMessagesIds=t},[s](e,{ids:t}){e.selectedMessagesIds=t},[o](e,{loadingMessages:t}){e.loadingMessages=t}};t["c"]={state:r,getters:c,actions:l,mutations:d}},"8f2e":function(e,t,a){},"94a6":function(e,t,a){},"97c9":function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return c}));var s=a("7530");const n="is_unread",i="is_flagged",o="has_attachment",r="is_encrypted",c=new Map([[n,{}],[i,{}],[o,{}],[r,{}]]),l={activeFilters:[]},d={setFilter({commit:e,state:t},{filter:a,active:n}){const i=n?[...t.activeFilters,a]:t.activeFilters.filter(e=>e!==a);return e(s["g"],{filters:i}),[...i]},setFilters({commit:e},{filters:t}){return e(s["g"],{filters:t}),[...t]}},u={[s["g"]](e,{filters:t}){e.activeFilters=t}};t["f"]={namespaced:!0,state:l,actions:d,mutations:u}},"9e4d":function(e,t,a){"use strict";a("94a6")},a763:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"g",(function(){return o})),a.d(t,"h",(function(){return r})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return l})),a.d(t,"i",(function(){return d})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return p}));var s=a("f00f");const n="Date ascending",i="Date descending",o="Sender ascending",r="Sender descending",c="Recipient ascending",l="Recipient descending",d=new Map([[o,[{term:"sender",order:"ascending"}]],[r,[{term:"sender",order:"descending"}]],[c,[{term:"recipient",order:"ascending"}]],[l,[{term:"recipient",order:"descending"}]],[n,[{term:"arrivaldate",order:"ascending"}]],[i,[{term:"arrivaldate",order:"descending"}]]]),u=new Map([[o,[{term:"sender",order:"ascending"}]],[r,[{term:"sender",order:"descending"}]],[n,[{term:"arrivaldate",order:"ascending"}]],[i,[{term:"arrivaldate",order:"descending"}]]]),p=new Map([[c,[{term:"recipient",order:"ascending"}]],[l,[{term:"recipient",order:"descending"}]],[n,[{term:"arrivaldate",order:"ascending"}]],[i,[{term:"arrivaldate",order:"descending"}]]]),m={sortOrder:i},g={setSortOrder({commit:e,state:t},{order:a}){return a!==t.sortOrder&&e(s["b"],{order:a}),t.sortOrder},resetSortOrder({commit:e}){e(s["a"])}},f={[s["b"]](e,{order:t}){e.sortOrder=t},[s["a"]](e){e.sortOrder=i}};t["j"]={state:m,actions:g,mutations:f}},b05a:function(e,t,a){"use strict";a("fbe7")},bc3e:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));a("14d9");const s="CHANGE_NEW_PAGE",n="SET_PAGE",i="SET_TOTAL",o="UPDATE_PAGE";let r=null;const c=200,l=(e,t,a)=>Math.max(t,Math.min(e,a)),d={page:1,newPage:1,pageSize:50,total:null},u={offset:e=>(e.page-1)*e.pageSize,currentPageSize:(e,t)=>l(e.total-t.newPageStart+1,0,e.pageSize),totalPages:e=>Math.ceil(e.total/e.pageSize),pageStart:e=>0===e.total?0:(e.page-1)*e.pageSize+1,newPageStart:e=>0===e.total?0:(e.newPage-1)*e.pageSize+1,newPageEnd:(e,t)=>t.newPageStart+t.currentPageSize-1},p={change({commit:e,state:t},{debounce:a,delta:n,router:i}){e(s,n),clearTimeout(r),r=setTimeout(()=>{e(o);const a={...i.currentRoute.query,page:t.newPage};delete a.message,i.push({...i.currentRoute,query:a})},a)},next({dispatch:e},{debounce:t=c,router:a}={}){return e("change",{debounce:t,delta:1,router:a})},previous({dispatch:e},{debounce:t=c,router:a}={}){return e("change",{debounce:t,delta:-1,router:a})}},m={[s](e,t){const a=Math.ceil(e.total/e.pageSize);e.newPage=l(e.newPage+t,1,a)},[n](e,t){e.newPage=e.page=t},[i](e,t){e.total=t},[o](e){e.page=e.newPage}};t["c"]={namespaced:!0,state:d,getters:u,actions:p,mutations:m}},bd5d:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i}));const s="SET_ACTIVE_SEARCH_QUERY",n="SHOW_SEARCH_INPUT",i="HIDE_SEARCH_INPUT"},bda7:function(e,t,a){"use strict";a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return r})),a.d(t,"f",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return u}));var s=a("ec51");const n="SET_LAYOUT_SPLIT",i="SET_DENSITY",o="No split",r="Horizontal split",c="Vertical split",l="density_default",d="density_compact",u=new Map([[l,{value:l,class:"",groupItems:!0}],[d,{value:d,groupItems:!1}]]),p={activeSplit:o,density:l},m={densityOption:e=>u.get(e.density),isCompactView:(e,t)=>t.densityOption.value===d,activeSplit:e=>e.activeSplit,isVerticalSplit:(e,t)=>t.activeSplit===c},g={async setLayoutSplit({commit:e,state:t},{layoutSplit:a}){return a!==t.layoutSplit&&(await Object(s["c"])("sm-layout-split",a),e(n,{layoutSplit:a})),t.layoutSplit},async setDensity({commit:e},{density:t}){await Object(s["c"])("sm-layout-density",t),e(i,{density:t})},async setDefaultSplit({commit:e}){await Object(s["c"])("sm-layout-split",o),e(n,{layoutSplit:o})}},f={[n](e,{layoutSplit:t}){e.activeSplit=t},[i](e,{density:t}){e.density=t}};t["g"]={namespaced:!0,state:p,getters:m,actions:g,mutations:f}},c3e6:function(e,t,a){"use strict";a("10e2")},c3f9:function(e,t,a){e.exports=a.p+"img/welcome.dc14367f.svg"},ca17:function(e,t,a){"use strict";a("6ba6")},cd49:function(e,t,a){"use strict";a.r(t);a("abe2");var s=a("2b0e"),n=a("003c"),i=a("5035"),o=a.n(i),r=(a("14d9"),a("8017"));let c=!1;function l(e){if(!c){c=!0;const t=document.createElement("script");t.async=!0,t.defer=!0,t.src=e;const a=document.head||document.getElementsByTagName("head")[0];a.appendChild(t)}}function d(e,t,a){window._paq.push(["setCustomUrl",document.URL]),a?window._paq.push(["trackEvent",e,t,a]):window._paq.push(["trackEvent",e,t])}function u(e){window._paq=window._paq||[];const t="https://matomo.startmail.com",a="1",s="startmail.com";if(!t||!a||!s)return void(e.prototype.$matomoTrackEvent=d);const n=t+"/matomo.php",i=t+"/matomo.js";window._paq.push(["setCookieDomain","*."+s]),window._paq.push(["setDoNotTrack",!0]),window._paq.push(["setDomains",["*."+s,"*.mail."+s]]),window._paq.push(["setSiteId",a]),window._paq.push(["setTrackerUrl",n]),e.prototype.$matomoTrackEvent=async function(e,t,a){d(e,t,a);const s=await this.$store.dispatch("features/getFeatures"),n=s.find(e=>e.id===r["FEATURE_MATOMO"]);n&&n.enabled&&l(i)}}a("88e6"),a("70cc"),a("eb03"),a("22e5"),a("c01e"),a("fa76"),a("8306");var p=a("1d41");const m="SET_AUTHENTICATION_STATUS",g="authentication/"+m,f="SET_CURRENT_USER",h="authentication/"+f,_="SET_TRIAL_STATUS",S="SET_SESSION_EXPIRY",y="SET_UNKNOWN_ERROR",E="SET_SETUP_GUIDE_VISIBILITY",b="SET_DOMAINS",v="SET_SETUP_GUIDE_COLLAPESED",I=15e3,T=3e5;class w{constructor(e){this.store=e.$store,this.router=e.$router,this.root=e.$root,this.monitorAuthenticationState()}monitorAuthenticationState(){this.store.subscribe(({type:e,payload:t})=>{e===g&&(t.isAuthenticated?this.router.afterEach(e=>{e.matched[0].name===p["MAIL"]?this.setupPeriodicPull():this.teardownPeriodicPull()}):this.teardownPeriodicPull())})}setPullTimer(e,t,a=I){this[e]=window.setTimeout(async()=>{const s=await t(),n=s?I:Math.min(a+a,T);this.setPullTimer(e,t,n)},a)}setupPeriodicPull(){this.updateTimer||this.setPullTimer("updateTimer",async()=>{const e=new Set(this.store.state.messages.activeMessagesIds);await this.store.dispatch("loadMessages");const t=new Set(this.store.state.messages.activeMessagesIds),a=e.symmetricDifference(t).size>0;return a})}teardownPeriodicPull(){window.clearTimeout(this.updateTimer),this.updateTimer=null}}var C={install(e){let t=null;e.mixin({beforeCreate(){t||(t=new w(this))}})}},A=a("5af9"),M=a("681c");const O="ENTITIES:BEFOREUNLOAD:SET",P="ENTITIES:BEFOREUNLOAD:REMOVE",N="ENTITIES:BEFOREUNLOAD:CLEAR_ALL",R="ENTITIES:FEATURES:SET",x="features/"+R,D="ENTITIES:FEATURES:LOADED_FEATURES";function k(e){A["a"]({Vue:e,dsn:Object({VUE_APP_STRIPE_PUBLISHABLE_KEY_LIVE:"pk_live_s29dnJbIfBMrOsLRfIl9XX6700VF3Xwmqb",VUE_APP_HCAPTCHA_SITEKEY:"62005f7f-8e3b-4695-8a82-36f5e27f2dfb",VUE_APP_CHARGEBEE_PUBLISHABLE_KEY_LIVE:"live_PtWfPPs84w90cXDXRhhCHxI3ln8HFCmz",VUE_APP_VERSION:"5.13.0",VUE_APP_MATOMO_BASE_DOMAIN:"startmail.com",VUE_APP_MATOMO_SITE_ID:"1",VUE_APP_STRIPE_PUBLISHABLE_KEY_TEST:"pk_test_yTFryGLeJSksHK1Z9oCEaIwW00ROJCb8vj",VUE_APP_MATOMO_HOST:"https://matomo.startmail.com",VUE_APP_CHARGEBEE_PUBLISHABLE_KEY_TEST:"test_kCIEIjBlezcuEhq9IE6INyZu5ATqsHaVD",NODE_ENV:"production",BASE_URL:"/"}).SENTRY_DSN,release:"5.13.0"}),F(e,e=>{e.$store.subscribe(({type:e,payload:t})=>{if(e===h)if(t){const{user:e}=t;M["h"]({username:e.id})}else M["h"](null)}),e.$store.subscribe(({type:e,payload:t})=>{if(e===x){const e=t.features.filter(e=>e.enabled).map(e=>e.id);M["f"]({features:e}),M["g"]("environment",e.includes(r["FEATURE_IS_CANARY"])?"canary":"production")}})})}function F(e,t){let a=!1;e.mixin({beforeCreate(){a||(t(this),a=!0)}})}a("d9e2");var L=a("cee4"),G=a("8c4f"),U=a("5488");const B={CookiesNotEnabled:()=>a.e("CookiesNotEnabled").then(a.bind(null,"c14d")),DeletedUserConfirmation:()=>a.e("DeletedUserConfirmation").then(a.bind(null,"f811")),LoginPage:()=>a.e("LoginPage").then(a.bind(null,"aeab")),NotFound:()=>a.e("NotFound").then(a.bind(null,"f86b")),UnifiedSignupFlow:()=>Promise.all([a.e("Signup~settings"),a.e("Signup")]).then(a.bind(null,"eea9")),SignupRecoveryCode:()=>Promise.all([a.e("Signup~settings"),a.e("Signup")]).then(a.bind(null,"8e63")),SignupFeedback:()=>Promise.all([a.e("Signup~settings"),a.e("Signup")]).then(a.bind(null,"5414")),SignupSupport:()=>Promise.all([a.e("Signup~settings"),a.e("Signup")]).then(a.bind(null,"2abf")),PasswordRecoveryConfirmation:()=>a.e("recovery").then(a.bind(null,"26e4")),PasswordRecoveryInitiate:()=>a.e("recovery").then(a.bind(null,"7658e")),PasswordRecoveryNewRecoveryCode:()=>a.e("recovery").then(a.bind(null,"596f")),PasswordRecoverySetNewPassword:()=>a.e("recovery").then(a.bind(null,"a9c9")),MailPage:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("mail~settings"),a.e("mail")]).then(a.bind(null,"7c41")),MessageDetailHeader:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("mail~settings"),a.e("mail")]).then(a.bind(null,"81b2")),Message:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("mail~settings"),a.e("mail")]).then(a.bind(null,"0a9b")),MessageList:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("mail~settings"),a.e("mail")]).then(a.bind(null,"5d7e")),MailHeader:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("mail~settings"),a.e("mail")]).then(a.bind(null,"b64b")),Compose:()=>Promise.all([a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("compose~settings"),a.e("compose")]).then(a.bind(null,"b2c7")),ComposeHeader:()=>Promise.all([a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("compose~settings"),a.e("compose")]).then(a.bind(null,"0b0a")),SubscriptionExpiredPage:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("expired")]).then(a.bind(null,"bf28")),ContactsPage:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("contacts")]).then(a.bind(null,"0a65b")),ContactGroupView:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("contacts")]).then(a.bind(null,"736b")),Contact:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("contacts")]).then(a.bind(null,"6c01")),ContactHeader:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("contacts")]).then(a.bind(null,"709d")),ContactDetailHeader:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("compose~contacts~mail"),a.e("contacts")]).then(a.bind(null,"7225")),SettingsPage:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"a445")),SettingsHeader:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"4a25")),MailSettingsGeneral:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"35cd")),FolderManagement:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"e5de")),Domains:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"03e3")),AddDomain:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"0cfc")),FolderManagementActions:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"dd84")),Encryption:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"7033")),Subscription:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"390c")),PGPKeyring:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"59bc")),KeyDetails:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"ea532")),KeyDetailHeader:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"4806")),ContactGroupManagement:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"971d")),ContactGroupActions:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"f195")),AccountSettings:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"bcf6")),ImapTokens:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"da9f")),ImapTokensHeader:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"aec9")),FiltersSettings:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"6d3c")),FiltersActions:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"6085")),RecoveryEmailConfirmation:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"2097")),EmailMigration:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"26d6")),Tutorials:()=>a.e("tutorials").then(a.bind(null,"8b71d")),GroupSubscriptionPage:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("compose~settings"),a.e("mail~settings"),a.e("Signup~settings"),a.e("settings")]).then(a.bind(null,"d4a4")),AliasesPage:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("aliases")]).then(a.bind(null,"483e")),BurnerAlias:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("aliases")]).then(a.bind(null,"2fe8")),CustomAliasesHeader:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("aliases")]).then(a.bind(null,"9c51")),CustomAliases:()=>Promise.all([a.e("aliases~contacts~expired~mail~settings"),a.e("aliases~compose~contacts~mail"),a.e("aliases")]).then(a.bind(null,"d4c9"))};var $=[{path:"/cookies-not-enabled",name:p["COOKIES_NOT_ENABLED"],component:B.CookiesNotEnabled,meta:{access:"public",title:e=>e.$gettext("Cookies not enabled")},props:!0},{path:"/login",name:p["LOGIN"],component:B.LoginPage,meta:{access:"unauthenticated",title:e=>e.$gettext("Login")}},{path:"/custom-domain-signup/:customDomainVerifier?",redirect:"/signup"},{path:"/signup/:couponCode",redirect:e=>({name:p["SIGNUP_DEFAULT"],query:{...e.query,deal:e.params.couponCode}})},{path:"/signup",name:p["SIGNUP_DEFAULT"],component:B.UnifiedSignupFlow,meta:{access:"unauthenticated",title:e=>e.$gettext("Signup"),featureFlag:r["FEATURE_SIGNUP"]}},{path:"/signup-recovery-code",name:p["SIGNUP_RECOVERY_CODE"],component:B.SignupRecoveryCode,meta:{access:"unauthenticated",title:e=>e.$gettext("Signup – Recovery code")},props:!0},{path:"/signup-feedback",name:p["SIGNUP_FEEDBACK"],component:B.SignupFeedback,meta:{access:"authenticated",title:e=>e.$gettext("Signup feedback")}},{path:"/password-recovery",name:p["PASSWORD_RECOVERY_INITIATE"],component:B.PasswordRecoveryInitiate,meta:{access:"public",title:e=>e.$gettext("Reset your password"),featureFlag:r["FEATURE_RECOVERY"]},props:!0},{path:"/password-recovery/confirmation",name:p["PASSWORD_RECOVERY_CONFIRMATION"],component:B.PasswordRecoveryConfirmation,meta:{access:"public",title:e=>e.$gettext("Reset your password"),featureFlag:r["FEATURE_RECOVERY"]}},{path:"/password-recovery/set-new-password",name:p["PASSWORD_RECOVERY_SET_NEW_PASSWORD"],component:B.PasswordRecoverySetNewPassword,meta:{access:"public",title:e=>e.$gettext("Reset your password"),featureFlag:r["FEATURE_RECOVERY"]},props:e=>({recoveryCode:e.query.recovery_code,user:e.query.user})},{path:"/password-recovery/new-recovery-code",name:p["PASSWORD_RECOVERY_NEW_RECOVERY_CODE"],component:B.PasswordRecoveryNewRecoveryCode,meta:{access:"public",title:e=>e.$gettext("One-time recovery code"),featureFlag:r["FEATURE_RECOVERY"]},props:!0},{path:"/user/recoveryEmail",name:p["RECOVERY_EMAIL_CONFIRMATION"],component:B.RecoveryEmailConfirmation,meta:{access:"public",title:e=>e.$gettext("Confirm recovery email"),featureFlag:r["FEATURE_RECOVERY"]},props:e=>({queryUsername:e.query.username,confirmationKey:e.query.token})},{path:"/user/recoveryEmail/:token",name:p["RECOVERY_EMAIL_CONFIRMATION_OLD"],component:B.RecoveryEmailConfirmation,meta:{access:"authenticated",title:e=>e.$gettext("Confirm recovery email"),featureFlag:r["FEATURE_RECOVERY"]},props:e=>({confirmationKey:e.params.token})},{path:"/deleted-account",name:p["DELETED_USER"],component:B.DeletedUserConfirmation,meta:{access:"public",title:e=>e.$gettext("Deleted account")}},{path:"/support",name:p["SIGNUP_SUPPORT"],component:B.SignupSupport,meta:{access:"public",title:e=>e.$gettext("Contact Support")}},{path:"/",redirect:"/mail"},{path:"/mail",name:p["MAIL"],component:B.MailPage,redirect:"/mail/folders/INBOX",children:[{path:"compose",name:p["MAIL_COMPOSE"],components:{appHeader:B.ComposeHeader,main:B.Compose},meta:{title:e=>e.$gettext("Compose")}},{path:"search",name:p["MAIL_SEARCH"],components:{appHeader:B.MailHeader,main:B.MessageList,pane:B.Message},meta:{title:e=>e.$gettext("Search")}},{path:"inbox",redirect:"/mail/folders/INBOX"},{path:"folders/:folder",name:p["MAIL_FOLDER"],components:{appHeader:B.MailHeader,main:B.MessageList,pane:B.Message},meta:{title:e=>{const t=e.$store.getters.activeFolder;if(t.id){const a=new U["a"],s=a.getFolderName.call(e,t),n=t.unread_messages_count||0;return n>0?`(${n}) ${s}`:s}}}},{path:":folder/:message",name:p["MAIL_MESSAGE"],components:{appHeader:B.MessageDetailHeader,main:B.Message},meta:{title:e=>{const t=e.$store.getters.activeMessage;return t&&t.subject||""}}}]},{path:"/contacts",redirect:"/contacts/groups/all",name:p["CONTACTS"],component:B.ContactsPage,children:[{path:"groups/:group",name:p["CONTACTS_GROUP"],components:{appHeader:B.ContactHeader,main:B.ContactGroupView},meta:{title:e=>e.$gettext("Contacts")}},{path:"search",name:p["CONTACTS_SEARCH"],components:{appHeader:B.ContactHeader,main:B.ContactGroupView},meta:{title:e=>e.$gettext("Search")}},{path:":contact",name:p["CONTACTS_CONTACT"],components:{appHeader:B.ContactDetailHeader,main:B.Contact},meta:{title:e=>{const t=e.$store.getters.activeContact;return null===t||void 0===t?void 0:t.display_name}}}]},{path:"/settings",name:p["SETTINGS"],component:B.SettingsPage,redirect:"/settings/account",children:[{path:"account",name:p["SETTINGS_ACCOUNT"],components:{main:B.AccountSettings},meta:{title:e=>e.$gettext("Account settings")}},{path:"mail/general",name:p["SETTINGS_MAIL"],components:{main:B.MailSettingsGeneral},meta:{title:e=>e.$gettext("Mail settings")}},{path:"mail/folders",name:p["SETTINGS_MAIL_FOLDERS"],components:{main:B.FolderManagement,appHeaderActions:B.FolderManagementActions},meta:{title:e=>e.$gettext("Folder settings")}},{path:"mail/domain",name:p["SETTINGS_DOMAINS"],components:{appHeaderActions:B.AddDomain,appHeader:B.SettingsHeader,main:B.Domains},meta:{access:"manager",title:e=>e.$gettext("Domains")},props:{appHeaderActions:{appHeader:!0}}},{path:"group-subscription",name:p["SETTINGS_GROUP_SUBSCRIPTIONS"],components:{main:B.GroupSubscriptionPage},meta:{access:"manager",title:e=>e.$gettext("Group subscription")}},{path:"encryption",name:p["SETTINGS_ENCRYPTION"],components:{main:B.Encryption},meta:{title:e=>e.$gettext("Encryption")}},{path:"subscription",name:p["SETTINGS_SUBSCRIPTION"],components:{main:B.Subscription},meta:{access:"manager",title:e=>e.$gettext("Subscription")}},{path:"tutorials",name:p["SETTINGS_TUTORIALS"],components:{main:B.Tutorials},meta:{title:e=>e.$gettext("Guides and tutorials")}},{path:"pgp-keyring",name:p["SETTINGS_PGP_KEYRING"],components:{main:B.PGPKeyring},meta:{title:e=>e.$gettext("PGP keyring")}},{path:"pgp-keyring/search",name:p["SETTINGS_PGP_KEYRING_SEARCH"],components:{main:B.PGPKeyring},meta:{title:e=>e.$gettext("Search")}},{path:"pgp-keyring/:fingerprint",name:p["SETTINGS_PGP_KEYRING_KEY"],components:{main:B.KeyDetails,appHeader:B.KeyDetailHeader},meta:{title:e=>e.$gettext("Key details")}},{path:"mail/imap",name:p["SETTINGS_IMAP_TOKENS"],components:{main:B.ImapTokens,appHeader:B.ImapTokensHeader},meta:{title:e=>e.$gettext("Trusted devices/IMAP"),featureFlag:r["FEATURE_IMAP_TOKENS"]}},{path:"mail/filters",name:p["SETTINGS_MAIL_FILTERS"],components:{main:B.FiltersSettings,appHeaderActions:B.FiltersActions},meta:{title:e=>e.$gettext("Filters"),featureFlag:r["FEATURE_FILTERS"]}},{path:"contact/contact-groups",name:p["SETTINGS_CONTACT_CONTACTGROUPS"],components:{main:B.ContactGroupManagement,appHeaderActions:B.ContactGroupActions},meta:{title:e=>e.$gettext("Contact groups")}},{path:"email-migration",name:p["SETTINGS_EMAIL_MIGRATION"],components:{main:B.EmailMigration},meta:{title:e=>e.$gettext("Email Migration")}}].map(e=>({...e,components:{...e.components,appHeader:e.components.appHeader||B.SettingsHeader}}))},{path:"/subscription-expired",name:p["SUBSCRIPTION_EXPIRED"],component:B.SubscriptionExpiredPage,meta:{access:"manager",title:e=>e.$gettext("Subscription expired")}},{path:"/aliases",name:p["ALIASES"],component:B.AliasesPage,redirect:{name:p["ALIASES_PERSONAL"]},children:[{path:"personal",name:p["ALIASES_PERSONAL"],components:{main:B.CustomAliases,appHeader:B.SettingsHeader,appHeaderActions:B.CustomAliasesHeader},props:{main:{type:"personal"},appHeaderActions:{type:"personal"}},meta:{title:e=>e.$gettext("Personal aliases")}},{path:"domain",name:p["ALIASES_DOMAIN"],components:{main:B.CustomAliases,appHeader:B.SettingsHeader,appHeaderActions:B.CustomAliasesHeader},props:{main:{type:"group"},appHeaderActions:{type:"group"}},meta:{title:e=>e.$gettext("Domain aliases")}},{path:"burner",name:p["ALIASES_BURNER"],components:{main:B.BurnerAlias,appHeader:B.SettingsHeader},meta:{title:e=>e.$gettext("Burner alias")}}]},{path:"*",component:B.MailPage,children:[{path:"/",components:{appHeader:B.MailHeader,main:B.NotFound},meta:{title:e=>e.$gettext("Page not found")}}]}],H=a("2f62"),j=a("79f6");const q="LOAD_ALIASES",V="REPLACE_BURNER",Y={namespaced:!0,state:{aliases:[],customDomains:[],startmailDomains:[]},getters:{burnerAlias:e=>e.aliases.find(e=>"burner"===e.type),personalAliases:e=>e.aliases.filter(e=>"personal"===e.type),domainAliases:e=>e.aliases.filter(e=>"group"===e.type&&!e.alias.startsWith("*@")),allowedAliasDomainNamesForType:e=>t=>"personal"===t?e.startmailDomains:e.customDomains.filter(e=>e.verified).map(e=>e.domain_name),senderAliases:(e,t,a)=>[{alias:a.authentication.user.email,created:"",editable:!1,id:"",type:"personal",enabled:!0,expires:null,displayName:a.authentication.user.preferences.display_name,note:"",recipients:[a.authentication.user.email]},...e.aliases.filter(e=>e.enabled&&(!e.expires||Date.parse(e.expires)>(new Date).getTime())&&"burner"!==e.type&&!e.alias.startsWith("*@")).sort((e,t)=>e.alias.localeCompare(t.alias)).sort((e,t)=>(t.displayName?1:0)-(e.displayName?1:0))].filter(e=>e.recipients.includes(a.authentication.user.email)),findSenderAlias:(e,t)=>e=>{for(const a of e)for(const e of t.senderAliases)if(a.toLowerCase()===e.alias.toLowerCase())return e},myAddresses:(e,t,a)=>[a.authentication.user.email,...e.aliases.filter(e=>!e.alias.startsWith("*@")).map(e=>e.alias.toLowerCase())],catchall:e=>t=>e.aliases.find(e=>e.alias==="*@"+t)},actions:{async loadAliases({commit:e,dispatch:t}){const{aliases:a,alias_domains:s}=await j["c"].aliases.get(),n=await t("authentication/getDomains",null,{root:!0});e(q,{aliases:a,customDomains:n,startmailDomains:s})},async createBurner({commit:e}){const t=await j["c"].aliases.createBurner();j["c"].uiEvents.create({event_type:"alias_created_burner"}),e(V,t)},async activate({dispatch:e},{id:t,active:a}){await j["c"].aliases.update({id:t,update:{enabled:a,expires:null}}),e("loadAliases")},async remove({dispatch:e},t){await j["c"].aliases.delete(t),e("loadAliases")},async enableCatchAll({dispatch:e,rootState:t},a){const s={alias:"*@"+a,display_name:"",expires:null,note:"",recipients:[t.authentication.user.email],type:"group"};await j["c"].aliases.create(s),await e("loadAliases")},async disableCatchAll({dispatch:e,state:t},a){const s=t.aliases.find(e=>e.alias==="*@"+a);s&&(await j["c"].aliases.delete(s.id),await e("loadAliases"))}},mutations:{[q]:(e,{aliases:t,customDomains:a,startmailDomains:s})=>{e.aliases=t,e.customDomains=[...a].sort((e,t)=>e.domain_name.localeCompare(t.domain_name)),e.startmailDomains=[...s].sort()},[V]:(e,t)=>{const a=e.aliases.findIndex(e=>"burner"===e.type);a>=0&&e.aliases.splice(a,1),e.aliases.push(t)}}};var K=Y;const W="authentication",z="sm-broadcast-channel",Q=Math.floor(1e6*Math.random());function X(e){if(!window.BroadcastChannel)return;const t=new window.BroadcastChannel(z);t.addEventListener("message",async({data:t})=>{if(t.senderIdentity===Q)return;if(t.type!==W)return;const a=t.payload.is_authenticated!==e.state.authentication.isAuthenticated,s=Boolean(t.payload.user)&&t.payload.user.id!==e.state.authentication.user.id;(a||s)&&(await e.dispatch("unloadAndRemoveAllFunctions"),location.reload())})}function J(e,t){if(!window.BroadcastChannel)return;const a=new window.BroadcastChannel(z);a.postMessage({type:e,payload:t,senderIdentity:Q})}var Z=a("76da");const ee=()=>({id:"",email:"",totp_enabled:!1,is_trial:!1,trial_days_remaining:null,has_subscription:!0,preferences:{locale:"",display_name:"",external_link_warning:!0,session_timeout_seconds:0,recovery_email:null,editor:{default_font_family:null,default_font_color:null,default_font_size:null},signature:"",date_format:"",time_format:"",pgp_auto_encrypt:!1,pgp_auto_sign:!1,pgp_auto_attach_public_key:!1,recipient_count_warning:!1,imap_access:!1,show_welcome_compose_modal:!1,setup_guide_visible:!0,setup_guide_completed_seen:!0,setup_guide_cards:[],migration_status_id:null},account_active_start:"",account_active_end:"",account_grace_end:"",account_termination_end:"",is_manager:!1,login_count:3,domains:[],max_domains:0}),te={namespaced:!0,state:{isAuthenticated:!1,sessionExpiry:0,user:ee(),unknownError:!1,setupGuideCollapsed:"true"===localStorage.getItem("setup-guide-collapsed")},getters:{user:e=>e.user,isInTrial:e=>!0===e.user.is_trial,activeDaysRemaining:e=>"string"===typeof e.user.account_active_end?Object(Z["a"])(e.user.account_active_end):null,canAddDomain:e=>{var t;return(null!==(t=e.user.domains)&&void 0!==t?t:[]).length<e.user.max_domains},isActive:e=>"string"===typeof e.user.account_active_end&&Object(Z["c"])(e.user.account_active_end),isLastActiveMonth:(e,t)=>"number"===typeof t.activeDaysRemaining&&t.activeDaysRemaining>=0&&t.activeDaysRemaining<=31,isInGrace:e=>"string"===typeof e.user.account_active_end&&"string"===typeof e.user.account_grace_end&&Object(Z["d"])(e.user.account_active_end,e.user.account_grace_end),isInQuarantine:e=>"string"===typeof e.user.account_grace_end&&Object(Z["b"])(e.user.account_grace_end),isManager:e=>!0===e.user.is_manager,hasSubscription:e=>!0===e.user.has_subscription,hasDomains:e=>e.user.domains&&e.user.domains.length>0,hasIncompleteDomains:e=>e.user.domains.some(e=>!e.completed),verifiedDomains:e=>e.user.domains.filter(e=>e.verified),isSetupGuideVisible:e=>e.user.preferences.setup_guide_visible,isSetupGuideCompletedSeen:e=>e.user.preferences.setup_guide_completed_seen,setupGuideCards:e=>e.user.preferences.setup_guide_cards,isSetupGuideCollapsed:e=>e.setupGuideCollapsed},mutations:{[m](e,{isAuthenticated:t}){e.isAuthenticated=t},[f](e,{user:t}){e.user={preferences:{},...t}},[_](e,{status:t}){e.user={...e.user,is_trial:t}},[S](e,t){e.sessionExpiry=t},[y](e,{error:t}){e.unknownError=t},[E](e,t){e.user.preferences.setup_guide_visible=t},[b](e,t){e.user.domains=t},[v](e,t){e.setupGuideCollapsed=t,localStorage.setItem("setup-guide-collapsed",JSON.stringify(t))}},actions:{async logout({dispatch:e}){await j["c"].authentication.logout(),J(W,{is_authenticated:!1}),await e("unloadAndRemoveAllFunctions",null,{root:!0}),window.location.assign("/login")},async login({dispatch:e},{email:t,password:a}){const s=await j["c"].authentication.login({email:t,password:a});return await e("processAuthentication",s),J(W,s),s},async totp({dispatch:e},{email:t,password:a,token:s}){const n=await j["c"].authentication.totp({email:t,password:a,token:s});return await e("processAuthentication",n),J(W,n),n},async getAuthenticationStatus({dispatch:e}){const t=await j["c"].authentication.get();return await e("processAuthentication",t),t},async disableTotp({commit:e,state:t},{password:a}){await j["c"].authentication.disableTotp({password:a}),e(f,{user:{...t.user,totp_enabled:!1}})},async getDomains({commit:e,state:t}){const a=t.user.is_manager?await j["c"].customDomains.all():[];return e(b,a),a},async updatePreferences({commit:e,state:t},{update:a}){const s=await j["c"].settings.update({update:a});e(f,{user:{...t.user,preferences:s}})},async getPreferences({commit:e,state:t}){const a=await j["c"].settings.get();e(f,{user:{...t.user,preferences:a}})},async processAuthentication({commit:e,dispatch:t},{is_authenticated:a,session_ttl:s,user:n}){if(a)await t("setSessionExpiryByTtl",s),e(f,{user:n}),await t("updateLanguage",{language:null===n||void 0===n?void 0:n.preferences.locale},{root:!0}),await t("features/getFeatures",{forceReload:!0},{root:!0}),e(m,{isAuthenticated:!0});else{Oa();const e="true"===localStorage.getItem("dark-mode");await t("setDarkMode",e,{root:!0});const a="true"===localStorage.getItem("dark-mode-editor-reset");await t("setDarkModeEditorReset",a,{root:!0}),await t("features/getFeatures",{forceReload:!0},{root:!0})}},getSessionExpiryAsTtl({state:e}){return e.sessionExpiry-Object(Z["g"])()},setSessionExpiryByTtl({commit:e},t){const a=Object(Z["g"])()+t-60;e(S,a)},async syncSubscription({dispatch:e}){await j["c"].chargebee.syncSubscription(),await e("getAuthenticationStatus")},setUnknownError({commit:e},{error:t}){e(y,{error:t})},async setSetupGuideVisibility({dispatch:e},t){await e("updatePreferences",{update:{setup_guide_visible:t}})},async setEmailMigrationSetupCardAsDone({dispatch:e}){await e("updatePreferences",{update:{setup_guide_cards:[{id:"import_emails",is_completed:!0}]}})},setSetupGuideCollapsed({commit:e},t){e(v,t)}}};var ae=te;const se="ADD_CONTACT_GROUP",ne="APPEND_CONTACTS",ie="CHANGE_CONTACT_COUNT",oe="LOADING_CONTACTS",re="REMOVE_CONTACT",ce="REMOVE_CONTACT_GROUP",le="RESET_LOADING_CONTACTS_ERRORS",de="SELECT_CONTACT",ue="SET_ACTIVE_CONTACT",pe="SET_ACTIVE_CONTACT_GROUP",me="SET_CONTACT",ge="SET_CONTACTS",fe="SET_CONTACT_FAVORITE_STATUS",he="SET_CONTACT_GROUPS",_e="SET_CONTACT_GROUPS_LOADED",Se="SET_LOADING_CONTACTS_ERROR",ye="SET_PRIMARY_ADDRESSES",Ee="SET_SELECTED_CONTACTS",be="UPDATE_CONTACT",ve="UPDATE_CONTACT_GROUP",Ie="SET_LOADING_CONTACT_GROUPS_ERROR";var Te=a("bc3e"),we=a("3651");const Ce={contacts:[],activeContact:null,loadingContacts:!1,loadingContactsError:null,selectedContacts:[],primaryAddresses:[]};function Ae(e){return e.filter(e=>e.email_addresses.length).map(e=>({email:(e.email_addresses.find(e=>e.is_primary)||e.email_addresses[0]).value,name:e.name}))}const Me={contacts:e=>e.contacts,loadingContacts:e=>e.loadingContacts,loadingContactsError:e=>e.loadingContactsError,activeContact:e=>e.activeContact,selectedContacts:e=>e.selectedContacts,selectedPrimaryEmailAddresses:e=>Ae(e.selectedContacts),allPrimaryAddresses:e=>e.primaryAddresses.map(e=>({email:e.email,name:e.name})),selectedContactsIds:e=>e.selectedContacts.map(e=>e.id)};function Oe({commit:e},t){return e(le),e(Ee,{contacts:[]}),e(oe,{loading:!0}),new Promise((a,s)=>{t().then(({contacts:t,total:s,primaryAddresses:n})=>{e(ge,{contacts:t}),e("pagination/"+Te["b"],s),e(oe,{loading:!1}),e(ye,{primaryAddresses:n}),a({contacts:t,total:s})}).catch(t=>{e(Se,{error:t}),e(oe,{loading:!1}),s(t)})})}const Pe={getContactsForGroup({commit:e,getters:t,rootState:a},{id:s,query:n}){return Oe({commit:e},()=>j["c"].contacts.find({groupId:s,offset:t["pagination/offset"],limit:a.pagination.pageSize,query:n}))},async getActiveContact({commit:e},{id:t}){const a=await j["c"].contacts.get({id:t});e(ue,{contact:a})},async addContact({commit:e},{contact:t}){const a=await j["c"].contacts.create({contact:t});return e(me,{contact:a}),e(ie,{groupIds:["all",...a.contact_group_ids],count:1}),a},async updateContact({commit:e,state:t},{id:a,contact:s}){const n=await j["c"].contacts.update({id:a,properties:s});if(t.activeContact&&t.activeContact.contact_group_ids){const a=n.contact_group_ids.filter(e=>!t.activeContact.contact_group_ids.includes(e));a.length&&e(ie,{groupIds:a,count:1});const s=t.activeContact.contact_group_ids.filter(e=>!n.contact_group_ids.includes(e));s.length&&e(ie,{groupIds:s,count:-1})}return e(ue,{contact:n}),n},async deleteContact({commit:e,rootState:t},{contact:a}){await j["c"].contacts.delete({id:a.id}),e(de,{contact:a,value:!1}),e(re,{contact:a});let s=["all",...a.contact_group_ids];return a.favorite&&s.push("favorites"),e("pagination/"+Te["b"],t.pagination.total-1),e(ie,{groupIds:s,count:-1}),a},deleteSelectedContacts({dispatch:e,state:t}){const a=t.selectedContacts.map(t=>e("deleteContact",{contact:t}));return Promise.all(a).then(t=>(e("deselectAllContacts"),t))},async moveContact({commit:e},{contact:t,contactGroupId:a}){const s=await j["c"].contacts.update({id:t.id,properties:{contact_group_ids:[...new Set([...t.contact_group_ids,a])]}});return t.contact_group_ids.includes(a)||e(ie,{groupIds:[a],count:1}),e(be,{contact:t,properties:s}),s},moveSelectedContacts({dispatch:e,state:t},{contactGroupId:a}){const s=t.selectedContacts.map(t=>e("moveContact",{contact:t,contactGroupId:a}));return Promise.all(s).then(t=>(e("deselectAllContacts"),t))},selectContact({commit:e},{contact:t,value:a}){e(de,{contact:t,value:a})},expandContactSelection({commit:e,getters:t},{contact:a,value:s}){const n=Object(we["a"])(t.contacts,Ce.selectedContacts,a,s);e(Ee,{contacts:n})},selectAllContacts({commit:e,getters:t}){e(Ee,{contacts:t.contacts.slice(0)})},deselectAllContacts({commit:e}){e(Ee,{contacts:[]})},setContactFavoriteStatus({commit:e},{id:t,favorite:a}){return j["c"].contacts.setFavoriteStatus({id:t,favorite:a}).then(t=>(e(fe,{id:t.id,favorite:t.favorite}),e(ie,{groupIds:["favorites"],count:t.favorite?1:-1}),"favorites"===ka.currentRoute.params.group&&(t.favorite?e(ne,{contacts:[t]}):e(re,{contact:t})),t))},toggleSelectedContactsFavoriteStatus({dispatch:e,state:t}){const a=t.selectedContacts.every(e=>e.favorite),s=t.selectedContacts.filter(({favorite:e})=>e!==!a),n=s.map(t=>{const s={id:t.id,favorite:!a};return e("setContactFavoriteStatus",s)});return Promise.all(n).then(t=>(e("deselectAllContacts"),t))},importContacts({commit:e},{files:t}){return j["c"].contacts.import({files:t}).then(({contact_group:t})=>(e(se,{contactGroup:t}),e(ie,{groupIds:["all"],count:t.contact_count}),{contactGroup:t}))}},Ne={[ne](e,{contacts:t}){e.contacts=[...e.contacts,...t]},[oe](e,{loading:t}){e.loadingContacts=t},[Se](e,{error:t}){e.loadingContactsError=t},[le](e){e.loadingContactsError=null},[ge](e,{contacts:t}){e.contacts=t},[ye](e,{primaryAddresses:t}){e.primaryAddresses=t},[me](e,{contact:t}){e.contacts.push(t)},[re](e,{contact:t}){const a=e.contacts.findIndex(({id:e})=>t.id===e);e.contacts.splice(a,1)},[be](e,{contact:t,properties:a}){const s=e.contacts.findIndex(({id:e})=>t.id===e);s>-1&&e.contacts.splice(s,1,{...e.contacts[s],...a,contact_group_ids:a.contact_group_ids||e.contacts[s].contact_group_ids})},[de](e,{contact:t,value:a}){if(a)e.selectedContacts.some(({id:e})=>t.id===e)||e.selectedContacts.push({...t});else{const a=e.selectedContacts.findIndex(({id:e})=>t.id===e);e.selectedContacts.splice(a,1)}},[Ee](e,{contacts:t}){e.selectedContacts=t},[ue](e,{contact:t}){e.activeContact=t},[fe](e,{id:t,favorite:a}){var s;const n=e.contacts.find(e=>e.id===t);n&&(n.favorite=a),(null===(s=e.activeContact)||void 0===s?void 0:s.id)===t&&(e.activeContact.favorite=a)},[oe](e,{loading:t}){e.loadingContacts=t}};var Re={state:Ce,getters:Me,actions:Pe,mutations:Ne};const xe=["all","favorites"],De={activeContactGroupId:"all",contactGroups:[],contactGroupsLoaded:!1,loadingContactGroupsError:null},ke={activeContactGroup:e=>e.contactGroups.find(t=>t.id===e.activeContactGroupId)||{},contactUserGroups:(e,t)=>t.contactGroups.filter(e=>!xe.includes(e.id)),contactGroups:e=>[...e.contactGroups].sort(Fe),loadingContactGroupsError:e=>e.loadingContactGroupsError};function Fe(e,t){return"all"===e.id||"all"===t.id?"all"===e.id?-1:1:"favorites"===e.id||"favorites"===t.id?"favorites"===e.id?-1:1:e.name.localeCompare(t.name,navigator.languages[0]||navigator.language,{numeric:!0,ignorePunctuation:!0})}const Le={async getContactGroups({commit:e}){const t=await j["c"].contactGroups.all();return e(he,{contactGroups:t}),e(_e),t},setActiveContactGroup({commit:e},{id:t}){e(pe,{id:t||"all"})},async addContactGroup({commit:e},{contactGroup:t}){const a=await j["c"].contactGroups.create({contactGroup:t});return e(se,{contactGroup:a}),a},async updateContactGroup({commit:e},{id:t,properties:a}){const s=await j["c"].contactGroups.update({id:t,properties:a});return e(ve,{id:t,properties:a}),s},async removeContactGroup({commit:e},{id:t}){const a=await j["c"].contactGroups.delete({id:t});return e(ce,{id:t}),a},setLoadingContactGroupsError({commit:e},{error:t}){e(Ie,{error:t})}},Ge={[pe](e,{id:t}){e.activeContactGroupId=String(t)},[_e](e){e.contactGroupsLoaded=!0},[he](e,{contactGroups:t}){e.contactGroups=t.map(e=>({...e,id:String(e.id)}))},[se](e,{contactGroup:t}){e.contactGroups.push({...t,id:String(t.id)})},[ve](e,{id:t,properties:a}){const s=e.contactGroups.findIndex(e=>e.id===t);e.contactGroups.splice(s,1,{...e.contactGroups[s],...a,id:String(a.id||e.contactGroups[s].id)})},[ce](e,{id:t}){const a=e.contactGroups.findIndex(e=>e.id===t);e.contactGroups.splice(a,1)},[ie](e,{groupIds:t,count:a}){t.forEach(t=>{const s=e.contactGroups.find(e=>e.id===t);s.contact_count=Math.max(0,s.contact_count+a)})},[Ie](e,{error:t}){e.loadingContactGroupsError=t}};var Ue={state:De,getters:ke,actions:Le,mutations:Ge},Be=a("e025");const $e={state:{beforeunloadFunctions:{}},getters:{beforeunloadFunctionById:e=>t=>e.beforeunloadFunctions[t],allbeforeunloadFunctions:e=>Object.values(e.beforeunloadFunctions)},mutations:{[O](e,t){e.beforeunloadFunctions={...t,...e.beforeunloadFunctions}},[P](e,t){s["a"].delete(e.beforeunloadFunctions,t)},[N](e){e.beforeunloadFunctions={}}},actions:{unloadAndRemoveAllFunctions({state:e,commit:t}){Object.values(e.beforeunloadFunctions).forEach(e=>{window.removeEventListener("beforeunload",e)}),t(N)},removeBeforeunloadFunction({commit:e},t){e(P,t)},addBeforeunloadFunction({commit:e},t){e(O,t)}}};var He=$e;a("13d5");const je=r,qe=Object.keys(je),Ve={namespaced:!0,state:{byId:{},loadedFeatures:null},getters:{allFeatures:e=>Object.values(e.byId),chargebeeSite:(e,t)=>{const a=t.featureById(r["FEATURE_IS_CANARY"]);return a&&a.enabled?"startmail-test":"startmail"},featureById:e=>t=>Object.prototype.hasOwnProperty.call(e.byId,t)?e.byId[t]:(0!==Object.keys(e.byId).length&&console.warn(`Unconfigured feature flag ${t} requested.`),{id:t,enabled:!1}),loaded:e=>()=>0!==Object.keys(e.byId).length},mutations:{[R](e,{features:t}){e.byId=t.reduce((e,t)=>({...e,[t.id]:t}),{})},[D](e,{promise:t}){e.loadedFeatures=t}},actions:{async getFeatures({state:e,commit:t},{forceReload:a}={}){if(!a&&e.loadedFeatures)return e.loadedFeatures;const s=qe.map(e=>je[e]),n=j["c"].features.get({flags:s}).then(e=>(t(R,{features:e}),e));return t(D,{promise:n}),n}}};var Ye=Ve;const Ke="ENTITIES:FOLDERS:DELETE",We="ENTITIES:FOLDERS:SET",ze="ENTITIES:FOLDERS:UPDATE",Qe="SET_LOADING_FOLDERS_ERROR",Xe="RESET_LOADING_FOLDERS_ERROR",Je=["inbox","flagged","drafts","sent","junk","trash"],Ze=Je.reverse();function et(e,t){return e.type!==t.type?Ze.indexOf(t.type)-Ze.indexOf(e.type):e.display_name.toUpperCase().localeCompare(t.display_name.toUpperCase())}function tt(e,t){const a=e.filter(({parent_id:e})=>e===t.id).map(t=>tt(e,t)).sort(et);return{...t,children:a}}var at={state:{byId:{},quota:{storage_used:null,storage_total:null},loadingFoldersError:!1},getters:{allFolders:e=>Object.values(e.byId),folderById:e=>t=>null===t?void 0:e.byId[t],folderTree(e,t){return t.allFolders.filter(({parent_id:e})=>!e).map(e=>tt(t.allFolders,e)).sort(et)},systemFolders(e,t){return Je.reduce((e,a)=>({...e,[a]:t.allFolders.find(e=>e.type===a&&!e.parent_id)||{}}),{})},loadingFoldersError:e=>e.loadingFoldersError},actions:{async loadFolders({commit:e}){const{folders:t}=await j["c"].folders.all();return e(We,{folders:t}),t},async createFolder({commit:e},{folder:t}){return j["c"].folders.create({folder:t}).then(t=>(e(ze,{folders:[t]}),t))},async deleteFolder({commit:e},{folder:t}){return j["c"].folders.delete({id:t.id}).then(a=>(e(Ke,{id:t.id}),a))},async patchFolder({commit:e,getters:t},{id:a,properties:s}){return j["c"].folders.update({id:a,properties:s}).then(s=>{if(a!==s.id){const n=tt(t.allFolders,{id:a}),i=e=>(e.children||[]).reduce((e,{children:t,...a})=>[...e,a,...i({...a,children:t})],[]),o=i(n);e(ze,{folders:o.map(e=>({...e,id:e.id.replace(a,s.id),parent_id:e.parent_id.replace(a,s.id)}))}),o.forEach(t=>e(Ke,{id:t.id})),e(Ke,{id:a})}return e(ze,{folders:[s]}),s})},changeUnreadMessagesCountInFolder({commit:e,getters:t},{folderId:a,unreadCount:s}){const n=t.folderById(a);return n&&e(ze,{folders:[{...n,unread_messages_count:Math.max(0,s)}]}),t.folderById(a)},setLoadingFoldersError({commit:e},{error:t}){e(Qe,{error:t})},resetLoadingFoldersError({commit:e}){e(Qe,{error:!1})}},mutations:{[Ke](e,{id:t}){s["a"].delete(e.byId,t)},[We](e,{folders:t}){e.byId=t.reduce((e,t)=>({...e,[t.id]:t}),{})},[ze](e,{folders:t}){t.forEach(t=>{s["a"].set(e.byId,t.id,{...e.byId[t.id],...t})})},[Qe](e,{error:t}){e.loadingFoldersError=t},[Xe](e){e.loadingFoldersError=!1}}};const st="ENTITIES:IMAP_TOKENS:SET_IMAP_TOKEN",nt="ENTITIES:IMAP_TOKENS:ADD_IMAP_TOKEN",it="ENTITIES:IMAP_TOKENS:REMOVE_IMAP_TOKEN",ot={namespaced:!0,state:{byIdentifier:{}},getters:{imapTokens:e=>Object.values(e.byIdentifier)},mutations:{[st](e,{imapTokens:t}){e.byIdentifier=t.reduce((e,t)=>({...e,[t.identifier]:t}),{})},[nt](e,{imapToken:t}){e.byIdentifier={...e.byIdentifier,[t.identifier]:t}},[it](e,{identifier:t}){s["a"].delete(e.byIdentifier,t)}},actions:{async loadImapTokens({commit:e}){const t=await j["c"].imapTokens.list();return e(st,{imapTokens:t}),t},async createImapToken({commit:e},{identifier:t,password:a}){const s=await j["c"].imapTokens.create({identifier:t,password:a});return e(nt,{imapToken:s}),s},async deleteImapToken({commit:e},{identifier:t,password:a}){await j["c"].imapTokens.delete({identifier:t,password:a}),e(it,{identifier:t})}}};var rt=ot,ct=(a("5377"),a("a763"));const lt="ENTITIES:MESSAGES:ADD_FULL",dt="ENTITIES:MESSAGES:DELETE_FULL",ut="ENTITIES:MESSAGES:UPDATE",pt="ENTITIES:MESSAGES:DELETE",mt="ENTITIES:MESSAGES:SET_LOADING";function gt(...e){return e.find(e=>Array.isArray(e))||[]}function ft(e,t){return e?{...e,...t,to:gt(t.to,e.to).filter(e=>"string"===typeof e.email),cc:gt(t.cc,e.cc).filter(e=>"string"===typeof e.email),bcc:gt(t.bcc,e.bcc).filter(e=>"string"===typeof e.email),files:gt(t.files&&t.files.length>0&&t.files,e.files),body:"string"===typeof t.body?t.body:"string"===typeof e.body?e.body:""}:t}function ht(e,t,a){if("string"!==typeof a.body)return a;const s=`/api/Messages/${e}/Attachments/`,n=`/api/Messages/${t}/Attachments/`;return{...a,body:a.body.replace(s,n),files:a.files.map(e=>({...e,url:e.url.replace(s,n)}))}}function _t(e,t,a,s){a.activeMessageId===s&&e("clearActiveMessage"),a.hasFullMessage(s)&&t(dt,{id:s}),t(pt,{id:s})}function St(e,t,a,s,n){a.activeFolder.id===n&&(e("setActiveMessages",{ids:[]}),t("pagination/"+Te["b"],0)),e("changeUnreadMessagesCountInFolder",{folderId:a.systemFolders.junk.id,unreadCount:0});for(const[i,o]of Object.entries(s.byId))o.folderId===n&&_t(e,t,a,i)}const yt={byId:{},fullMessageIds:[],debouncedMessageLoading:!1},Et={messageById:e=>t=>e.byId[t],hasFullMessage:e=>t=>e.fullMessageIds.includes(t)},bt={async loadMessages({commit:e,dispatch:t,getters:a,rootState:s}){const n=s.folders.activeFolderId,i=s.search.activeSearchQuery,o=a["pagination/offset"],r=s.pagination.pageSize,c=s.sorting.sortOrder,l=ct["i"].get(c),d=s.filters.activeFilters,{total:u,messages:p}=await j["c"].messages.get({folderId:n,query:i,offset:o,limit:r,order:l,filter:d});return e(ut,{messages:p.map(({body:e,css_prefix:t,...a})=>a)}),t("loadFolders"),n===s.folders.activeFolderId&&i===s.search.activeSearchQuery&&o===a["pagination/offset"]&&r===s.pagination.pageSize&&c===s.sorting.sortOrder&&d===s.filters.activeFilters&&(t("setActiveMessages",{ids:p.map(({id:e})=>e)}),e("pagination/"+Te["b"],u)),{total:u,messages:p}},async readMessage({commit:e,dispatch:t,getters:a},{id:s}){const n=a.messageById(s)||{},i=a.folderById(n.folder_id);if(n.unread&&i&&t("changeUnreadMessagesCountInFolder",{folderId:n.folder_id,unreadCount:i.unread_messages_count-1}),a.hasFullMessage(s))n.unread&&t("changeMessagesReadStatus",{messagesIds:[s],unread:!1});else{const t=await j["c"].messages.getOne({id:s});e(ut,{messages:[t]}),e(lt,{id:s})}return a.messageById(s)},async decryptMessage({commit:e,getters:t,state:a},{id:s,pgpPassphrase:n,rememberPgpPassphrase:i}){const o={id:s,pgpPassphrase:n,rememberPgpPassphrase:i},r=await j["c"].messages.decrypt(o);if(e(ut,{messages:[r]}),e(lt,{id:r.id}),i){const n=a.fullMessageIds.map(t.messageById),i=n.filter(e=>e.id!==s&&e.flags.is_encrypted&&0!==e.pgp.encryption.status);i.forEach(({id:t})=>{e(dt,{id:t})})}return r},async emptyTrash({dispatch:e,commit:t,getters:a,state:s}){const n=a.systemFolders.trash.id;return St(e,t,a,s,n),await j["c"].trash.empty()},async emptyJunk({dispatch:e,commit:t,getters:a,state:s}){const n=a.systemFolders.junk.id;return St(e,t,a,s,n),await j["c"].junk.empty()},async deleteMessage({commit:e,dispatch:t,getters:a,rootState:s},{messageId:n}){const i=a.messageById(n);if(i){i.unread&&t("changeUnreadMessagesCountInFolder",{folderId:i.folder_id,unreadCount:a.folderById(i.folder_id).unread_messages_count-1});const n=s.messages.activeMessagesIds;n.includes(i.id)&&t("setActiveMessages",{ids:n.filter(e=>e!==i.id)}),_t(t,e,a,i.id)}return await j["c"].messages.delete({id:n})},async moveMessagesToFolder({commit:e,dispatch:t,getters:a,rootState:s},{messagesIds:n,folderId:i}){const o=n.map(a.messageById),r=o.filter(e=>e.unread),c=[...new Set(r.map(({folder_id:e})=>e))].map(a.folderById);c.forEach(e=>{const a=r.filter(({folder_id:t})=>t===e.id);t("changeUnreadMessagesCountInFolder",{folderId:e.id,unreadCount:e.unread_messages_count-a.length})});const l=a.folderById(i);t("changeUnreadMessagesCountInFolder",{folderId:i,unreadCount:l.unread_messages_count+r.length});const d=s.messages.activeMessagesIds;t("setActiveMessages",{ids:d.filter(e=>!n.includes(e))});const u=await j["c"].messages.bulk({messages:n,update:{folder_id:i}});let p=[];for(const[m,g]of Object.entries(u))if(g.id&&g.id!==m){const s=g.id,n=a.messageById(m)||{},i=ft(n,g),o=ht(m,s,i);e(ut,{messages:[o]}),a.hasFullMessage(m)&&e(lt,{id:s}),_t(t,e,a,m),p.push(s)}else e(ut,{messages:[{...g,id:m}]}),p.push(m);return p.map(a.messageById)},async moveMessagesToTrash({dispatch:e,getters:t},{messagesIds:a}){return e("moveMessagesToFolder",{messagesIds:a,folderId:t.systemFolders.trash.id})},async markMessagesAsSpam({dispatch:e,getters:t},{messagesIds:a}){return e("moveMessagesToFolder",{messagesIds:a,folderId:t.systemFolders.junk.id})},async markMessagesAsNotSpam({dispatch:e,getters:t},{messagesIds:a}){return e("moveMessagesToFolder",{messagesIds:a,folderId:t.systemFolders.inbox.id})},async reportMessage(e,{messageId:t,reportType:a}){await j["c"].messages.report({message:t,reportType:a})},async deleteTrashedMessages({commit:e,dispatch:t,getters:a,rootState:s},{messagesIds:n}){const i=s.messages.activeMessagesIds;t("setActiveMessages",{ids:i.filter(e=>!n.includes(e))}),n.forEach(s=>{_t(t,e,a,s)});const o=await j["c"].messages.bulk({messages:n,update:{delete:!0}});return Object.keys(o)},async changeMessagesReadStatus({commit:e,dispatch:t,getters:a},{messagesIds:s,unread:n}){const i=s.map(a.messageById),o=i.filter(e=>e.unread!==n),r=[...new Set(o.map(({folder_id:e})=>e))].map(a.folderById);r.forEach(e=>{const a=o.filter(({folder_id:t})=>t===e.id),s=n?+a.length:-a.length;t("changeUnreadMessagesCountInFolder",{folderId:e.id,unreadCount:e.unread_messages_count+s})});const c=s.map(a.messageById).map(e=>({...e,unread:n}));return e(ut,{messages:c}),await j["c"].messages.bulk({messages:s,update:{unread:n}}),c},async changeMessagesFlagStatus({commit:e,getters:t},{messagesIds:a,flagged:s}){const n=a.map(t.messageById).map(e=>({...e,flagged:s}));return e(ut,{messages:n}),await j["c"].messages.bulk({messages:a,update:{flagged:s}}),n},updateDebounceMessageLoading({commit:e},{isLoading:t}){e(mt,{isLoading:t})}},vt={[lt](e,{id:t}){e.fullMessageIds=[...new Set(e.fullMessageIds.concat(t))]},[dt](e,{id:t}){e.fullMessageIds=e.fullMessageIds.filter(e=>e!==t)},[ut](e,{messages:t}){t.forEach(t=>{const a=e.byId[t.id]||{},n=ft(a,t);s["a"].set(e.byId,t.id,n)})},[pt](e,{id:t}){delete e.byId[t]},[mt](e,{isLoading:t}){e.debouncedMessageLoading=t}};var It={state:yt,getters:Et,actions:bt,mutations:vt};const Tt="ENTITIES:KEYS:SET_KEYS",wt="ENTITIES:KEYS:SET_TOTAL",Ct="ENTITIES:KEYS:DELETE_KEY";var At={state:{byFingerprint:{},total:null},getters:{keys:e=>Object.values(e.byFingerprint),keysCount:(e,t)=>t.keys.length},actions:{loadKeys({commit:e},{query:t}={}){return j["c"].keys.get({query:t}).then(({keys:t,total:a})=>{e(Tt,{keys:t}),e(wt,{total:a})})},deleteKey({commit:e},{fingerprint:t}){return j["c"].keys.delete({fingerprint:t}).then(()=>e(Ct,{fingerprint:t}))},importKeys(e,{files:t,keyData:a}){return j["c"].keys.import({files:t,keyData:a}).then(({files:e,key_data:t})=>({files:e,keyData:t}))}},mutations:{[Tt](e,{keys:t}){e.byFingerprint=t.reduce((e,t)=>({...e,[t.fingerprint]:t}),{})},[wt](e,{total:t}){e.total=t},[Ct](e,{fingerprint:t}){s["a"].delete(e.byFingerprint,t)}}};const Mt="ENTITIES:QUOTA:SET",Ot={namespaced:!0,state:{storage_used:null,storage_total:null},getters:{storagePercentageUsed:e=>e.storage_total?e.storage_used&&100*e.storage_used/e.storage_total:0,storageFull:(e,t)=>t.storagePercentageUsed>=100,storageAlmostFull:(e,t)=>t.storagePercentageUsed>=95&&!t.storageFull},actions:{getQuotaInformation({commit:e}){return j["c"].quota.get().then(({storage_used:t,storage_total:a})=>{e(Mt,{storage_used:t,storage_total:a})})}},mutations:{[Mt](e,{storage_used:t,storage_total:a}){e.storage_used=t,e.storage_total=a}}};var Pt=Ot,Nt={modules:{beforeunload:He,features:Ye,folders:at,imapTokens:rt,messages:It,keys:At,quota:Pt}},Rt=a("97c9"),xt=a("bd5d"),Dt=a("8d8d"),kt=a("f00f");const Ft="MAIL:FOLDERS:SET_ACTIVE_FOLDER";var Lt={state:{activeFolderId:null},getters:{activeFolder:(e,t)=>t.folderById(e.activeFolderId)||{},activeFolderPath(e,t){function a(e){return e?[...a(t.folderById(e.parent_id)),e.id]:[]}return a(t.activeFolder)}},actions:{setActiveFolder({commit:e,state:t},{folderId:a}){return e(xt["b"],{query:null}),a!==t.activeFolderId&&(e(Ft,{folderId:a}),e("pagination/"+Te["a"],1),e("pagination/"+Te["b"],null),e(kt["a"]),e(Dt["b"],{ids:[]})),t.activeFolderId}},mutations:{[Ft](e,{folderId:t}){e.activeFolderId=t}}},Gt=a("bda7"),Ut={state:{activeSearchQuery:null,searchToggled:!1},actions:{setActiveSearchQuery({commit:e,state:t},{query:a}){return e(Ft,{folderId:null}),a!==t.activeSearchQuery&&(e(xt["b"],{query:a}),e("pagination/"+Te["a"],1),e("pagination/"+Te["b"],null),e(kt["a"]),e(Dt["b"],{ids:[]})),t.activeSearchQuery}},mutations:{[xt["b"]](e,{query:t}){e.activeSearchQuery=t},[xt["c"]](e){e.searchToggled=!0},[xt["a"]](e){e.searchToggled=!1}}},Bt=(a("88a7"),a("271a"),a("5494"),a("ec51"));const $t="SET_VERSION",Ht="SET_DARK_MODE",jt="SET_DARK_MODE_EDITOR_RESET",qt="SET_RECENT_RECIPIENTS",Vt="DELETE_RECIPIENT",Yt={version:null,darkMode:"true"===localStorage.getItem("dark-mode"),darkModeResetEditor:"true"===localStorage.getItem("dark-mode-editor-reset"),recentRecipients:null},Kt={version:()=>Yt.version},Wt={async loadLanguage({dispatch:e}){const t=new window.URLSearchParams(window.location.search).get("lang")||await Object(Bt["a"])("sm-settings-language")||window.navigator.language||window.navigator.userLanguage;null!==t&&e("updateLanguage",{language:t})},loadRecentRecipients({commit:e}){return j["c"].recentRecipients.get().then(t=>{e(qt,{recipients:t})})},async deleteRecentRecipient({commit:e},t){await j["c"].recentRecipients.deleteOne(t),e(Vt,t)},async deleteRecentRecipients({commit:e}){await j["c"].recentRecipients.delete(),e(qt,{recipients:[]})},async updateLanguage(e,{language:t}){Qt(t),await Object(Bt["c"])("sm-settings-language",t)},setLanguage({dispatch:e},{language:t}){e("updateLanguage",{language:t}),e("authentication/updatePreferences",{update:{locale:t}})},async setExternalLinkWarning({dispatch:e},{externalLinkWarning:t}){e("authentication/updatePreferences",{update:{external_link_warning:t}})},async setRecipientCountWarning({dispatch:e},{recipientCountWarning:t}){e("authentication/updatePreferences",{update:{recipient_count_warning:t}})},setDarkModeEditorReset({commit:e},t){e(jt,t)},setDarkMode({commit:e},t){e(Ht,t)}},zt={[$t](e,{version:t}){e.version=t},[Ht](e,t){e.darkMode=t,localStorage.setItem("dark-mode",JSON.stringify(t))},[jt](e,t){e.darkModeResetEditor=t,localStorage.setItem("dark-mode-editor-reset",JSON.stringify(t))},[qt](e,{recipients:t}){e.recentRecipients=[...t]},[Vt](e,t){e.recentRecipients=e.recentRecipients.filter(e=>e.id!==t)}};function Qt(e){e=e.startsWith("de")?"de_DE":e.startsWith("nl")?"nl":"en_US",s["a"].config.language=e,document.documentElement.lang=e.replace("_","-")}var Xt={actions:Wt,getters:Kt,mutations:zt,state:Yt};const Jt="INIT_SIDEBAR_STATUS",Zt="TOGGLE_SIDEBAR",ea="SET_MOBILE_MENU",ta={sidebarIsOpen:!0,sidebarDesktopState:!0,isMobileMenu:!1},aa={sidebarIsOpen:e=>e.sidebarIsOpen,isMobileMenu:e=>e.isMobileMenu},sa={async loadSidebarStatus({commit:e}){let t=await Bt["a"]("sidebar-is-open");null!==t?(t="true"===t,e(Jt,{sidebarStatus:t})):e(Jt,{sidebarStatus:ta.sidebarDesktopState})},toggleSidebar({commit:e}){e(Zt)},setMobileMenu({commit:e},t){e(ea,t)},closeMobileSidebar({state:e,commit:t}){e.sidebarIsOpen&&e.isMobileMenu&&t(Zt)}},na={[Jt](e,{sidebarStatus:t}){e.sidebarIsOpen=t,e.sidebarDesktopState=e.sidebarIsOpen},[Zt](e){e.isMobileMenu?e.sidebarIsOpen=!e.sidebarIsOpen:(e.sidebarIsOpen=!e.sidebarIsOpen,e.sidebarDesktopState=e.sidebarIsOpen,Bt["c"]("sidebar-is-open",JSON.stringify(e.sidebarIsOpen)))},[ea](e,t){e.isMobileMenu=t,e.isMobileMenu?e.sidebarIsOpen=!1:e.sidebarIsOpen=e.sidebarDesktopState}};var ia={state:ta,getters:aa,actions:sa,mutations:na};const oa="SET_DOMAIN_TOKEN",ra="SET_SIGNUP_DOMAIN",ca={namespaced:!0,state:{domain:"startmail.com",domainToken:null},actions:{setSignupDomain({commit:e},t){e(ra,t)},setDomainToken({commit:e},t){e(oa,t)}},mutations:{[ra](e,t){e.domain=t},[oa](e,t){e.domainToken=t}}};var la=ca,da=a("8785");const ua="CHARGEBEE_PLAN",pa="GROUP_SUBSCRIPTIONS",ma="SET_CURRENCY",ga={namespaced:!0,state:{currency:"USD",groupSubscription:null,chargebeePlan:null},getters:{isAccountCreateAllowed:e=>{var t;return null===(t=e.groupSubscription)||void 0===t?void 0:t.create_account.is_allowed},accountCreateNotAllowedReasons:e=>{var t;return(null===(t=e.groupSubscription)||void 0===t?void 0:t.create_account.reasons)||[]},hasMultipleAccounts:(e,t)=>void 0!==t.numberOfAccounts?t.numberOfAccounts>1:void 0,numberOfAccounts:e=>{var t;return null===(t=e.groupSubscription)||void 0===t?void 0:t.accounts.length},nextAccountTier:(e,t)=>{const a=t.numberOfAccounts;if(e.chargebeePlan&&void 0!==a)return e.chargebeePlan.tiers.find(e=>e.starting_unit<=a+1&&(!e.ending_unit||e.ending_unit>=a+1))}},mutations:{[ma](e,t){e.currency=t},[pa](e,t){e.groupSubscription=t},[ua](e,t){e.chargebeePlan=t}},actions:{async getUserCurrency({commit:e}){const{currency:t}=await j["c"].chargebee.userCurrency();e(ma,t)},async getGroupSubscriptions({commit:e}){const t=await j["c"].groupSubscriptions.getGroupSubscriptions();e(pa,t)},async getChargebeePlan({commit:e}){const t=await j["c"].chargebee.getChargebeePlan();e(ua,t)}}};var fa=ga,ha=a("c6e6");const _a=6e4,Sa=new RegExp("^(/api/[a-zA-Z]+).*$"),ya=["domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","fetchStart","requestStart","responseStart","responseEnd","transferSize","duration"],Ea=[ha["BROWSER_METRICS_ENDPOINT"]];class ba{constructor(e){window.performance&&"function"===typeof window.performance.clearResourceTimings&&(this.endpoints=this.prepareEndpoints(),this.store=e,this.timer=null,this.handleAuthenticationChange())}shouldSendMetrics(){const e=this.store.getters["features/featureById"](r["FEATURE_BROWSER_METRICS"]);return"undefined"!==typeof e&&e.enabled}prepareEndpoints(){return Object.values(ha).filter(e=>"string"===typeof e).sort((e,t)=>t.length-e.length)}handleAuthenticationChange(){this.store.subscribe(({type:e,payload:t})=>{if(e===g){const{isAuthenticated:e}=t;e?this.timer=setInterval(this.reportMetrics.bind(this),_a):this.timer&&(clearInterval(this.timer),this.timer=null)}})}reportMetrics(){const e=window.performance;try{if(!this.shouldSendMetrics())return;const t=e.getEntriesByType("resource"),a=[];t.forEach(e=>{if("xmlhttprequest"===e.initiatorType){const t=this.determineEndpoint(e.name);t&&-1===Ea.indexOf(t)&&a.push(this.createResourceTiming(t,e))}},this),a.length>0&&j["c"].browsermetrics.post({frontend_version:this.store.getters["version"],resources:a})}finally{e.clearResourceTimings()}}determineEndpoint(e){const t=e.substr(e.indexOf("/","https://".length));for(let s=0;s<=this.endpoints.length;s++){const e=this.endpoints[s];if(t.startsWith(e))return e}const a=t.match(Sa);return a&&2===a.length?a[1]:null}createResourceTiming(e,t){const a={};return ya.forEach(e=>{a[e]=t[e]}),{endpoint:e,properties:a}}}function va(){return e=>{new ba(e)}}const Ia=!1,Ta=va();var wa={modules:{aliases:K,authentication:ae,contacts:Re,contactGroups:Ue,drafts:Be["b"],entities:Nt,filters:Rt["f"],folders:Lt,layout:Gt["g"],messages:Dt["c"],pagination:Te["c"],sorting:ct["j"],search:Ut,settings:Xt,sidebar:ia,signup:la,toast:da["a"],legacyToast:da["b"],subscription:fa},strict:Ia,plugins:[Ta]};s["a"].use(H["a"]);const Ca=new H["a"].Store(wa);var Aa=Ca;const Ma=JSON.stringify(Ca.state);function Oa(){Ca.replaceState(JSON.parse(Ma))}const Pa=!1;async function Na(e,t,a){try{await Aa.dispatch("features/getFeatures")}catch(r){}if(e.meta.featureFlag){var s,n;const t=null===(s=(n=Aa.getters)["features/featureById"])||void 0===s?void 0:s.call(n,e.meta.featureFlag);var i,o;if(t?t.enabled:Pa)a();else!t&&null!==(i=(o=Aa.getters)["features/loaded"])&&void 0!==i&&i.call(o)&&M["c"](`Disabling unknown feature ${e.meta.featureFlag}, redirect to root`,"warning"),a({path:"/"})}else a()}var Ra=a("9902");s["a"].use(G["b"]);const xa=new Map,Da=new G["b"]({mode:"history",routes:$,scrollBehavior(e,t){return e.name===t.name?{}:xa.has(e.fullPath)?new Promise(t=>{window.setTimeout(()=>t(xa.get(e.fullPath)),200)}):{x:0,y:0}}});var ka=Da;function Fa(e,t,a){return navigator.cookieEnabled||e.name===p["COOKIES_NOT_ENABLED"]?a():a({name:p["COOKIES_NOT_ENABLED"],params:{originalToPath:e}})}async function La(e,t,a){var s;if(!Da.app)return a();let n;const i=null!==(s=e.meta.access)&&void 0!==s?s:"authenticated",o=Da.app.$store;if("public"===i)return a();try{n=o.state.authentication.isAuthenticated||(await o.dispatch("authentication/getAuthenticationStatus")).is_authenticated}catch(d){var r;if(401!==(null===(r=d.response)||void 0===r?void 0:r.status))throw o.dispatch("authentication/setUnknownError",{error:d}),d;n=!1}if("unauthenticated"===i)return n?a({name:p["MAIL"]}):a();const c=n&&o.getters["authentication/isInQuarantine"],l=n&&o.getters["authentication/isManager"];if(c&&e.name!==p["SUBSCRIPTION_EXPIRED"]){if(l)return a({name:p["SUBSCRIPTION_EXPIRED"]});throw await o.dispatch("authentication/logout"),new Error("should never get back here after logout")}if(!c&&e.name===p["SUBSCRIPTION_EXPIRED"])return a({name:p["MAIL"]});if("manager"===i)return l?a():a({name:p["MAIL"]});if("authenticated"===i){if(n)return a();await o.dispatch("authentication/logout")}}function Ga(e,t,a){"FolderView"!==t.name&&"SearchMail"!==t.name||xa.set(t.fullPath,{x:window.pageXOffset,y:window.pageYOffset}),a()}Da.beforeEach(Fa),Da.beforeEach(La),Da.beforeEach(Na),Da.beforeEach(Ga);const Ua=Da.push;Da.push=async function(e,t,a){if(t||a)return Ua.call(this,e,t,a);try{return await Ua.call(this,e,t,a)}catch(s){if(!s||"NavigationDuplicated"===s.name)return this.currentRoute;throw s}},L["a"].interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code)===Ra["H"]&&Da.app.$store.state.authentication.isAuthenticated&&location.assign("/login"),Promise.reject(e)});var Ba,$a,Ha=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("DarkMode",[t("div",{class:{"sidebar-open":e.sidebarIsOpen,"sidebar-collapsed":!e.sidebarIsOpen}},[e.unknownError?t("Error"):t("router-view",{staticClass:"main-router-wrap"}),t("ToastNotification"),e.showSubscriptionBar?t("SubscriptionNotificationBar"):e.showIncompleteDomainsBar?t("IncompleteDomainNotificationBar"):e._e(),e.modalComponent?t(e.modalComponent,{tag:"component",attrs:{"modal-is-open":e.modalIsOpen},on:{close:e.removeModalQuery,modalToggled:e.removeModalQuery}}):e._e(),t("SessionExpiryHandler")],1)])},ja=[],qa=s["a"].extend({render(e){var t,a,s;return null!==(t=null===(a=(s=this.$scopedSlots).default)||void 0===a||null===(a=a.call(s,{}))||void 0===a?void 0:a[0])&&void 0!==t?t:e()},watch:{"$store.state.settings.darkMode":{handler:function(e){document.documentElement.classList.toggle("dark-mode",e)},immediate:!0}}}),Va=qa,Ya=a("2877"),Ka=Object(Ya["a"])(Va,Ba,$a,!1,null,null,null),Wa=Ka.exports,za=function(){var e=this,t=e._self._c;return t("div",{staticClass:"error-page"},[t("router-link",{attrs:{to:e.mailRoute}},[t("Logo")],1),t("div",{staticClass:"error-page-container"},[e.desktopMode?t("img",{attrs:{alt:"",src:a("20fc")}}):t("img",{attrs:{alt:"",src:a("602e")}}),t("div",{staticClass:"content"},[t("h1",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Oh no, this page can’t be reached…")]),t("p",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Something went wrong. Try again later.")])])])],1)},Qa=[],Xa=a("e532"),Ja=a("543e");const Za=window.matchMedia(Ja["a"].SIDEBAR_NOT_COLLAPSED);var es={components:{Logo:Xa["a"]},name:"Error",data(){return{desktopMode:Za.matches}},computed:{mailRoute(){return{name:p["MAIL"]}}},created(){Za.addEventListener?Za.addEventListener("change",this.handleResize):Za.addListener(this.handleResize)},methods:{handleResize(e){this.desktopMode=e.matches}}},ts=es,as=(a("b05a"),Object(Ya["a"])(ts,za,Qa,!1,null,"76eca3b6",null)),ss=as.exports,ns=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("ModalDialog",{attrs:{"start-open":""}},[t("div",{staticClass:"welcome-modal"},[t("h3",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v(" Welcome to StartMail and congratulations for choosing privacy! ")]),t("p",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v(" With StartMail, your email will always be private and secure. ")]),t("h4",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("First steps")]),t("ul",[t("li",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v(" Secure your account by changing your password and optionally enabling two-factor authentication. ")]),t("li",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v(" Review account recovery methods so that you can always recover access if you forget your password. ")])]),t("router-link",{staticClass:"button button--primary",attrs:{to:{name:e.SETTINGS_ACCOUNT}}},[t("translate",[e._v("Go to settings")])],1)],1)])},is=[],os=a("1eb7"),rs=s["a"].extend({components:{ModalDialog:os["a"],RouterLink:G["a"]},data(){return{SETTINGS_ACCOUNT:p["SETTINGS_ACCOUNT"]}}}),cs=rs,ls=(a("1376"),Object(Ya["a"])(cs,ns,is,!1,null,"8096e5c4",null)),ds=ls.exports,us=function(){var e=this,t=e._self._c;return t("NotificationBar",{staticClass:"incomplete-domain-notification-bar",attrs:{error:""}},[t("translate",[e._v(" Before you can send or receive emails you have to complete your domain setup. ")]),e.showButton?t("router-link",{staticClass:"button button--accent incomplete-domain-notification-bar__button",attrs:{to:{name:e.SETTINGS_DOMAINS}}},[t("Icon",{staticClass:"incomplete-domain-notification-bar__button-icon",attrs:{symbol:"gear"}}),e._v(" "+e._s(e.buttonText)+" ")],1):e._e()],1)},ps=[],ms=function(){var e=this,t=e._self._c;return e.active?t("div",{staticClass:"notification-bar",class:[{"notification-bar--error":e.error}]},[e._t("default"),e.dismissable?t("button",{staticClass:"button button--clean notification-bar__dismiss-button",attrs:{type:"button"},on:{click:e.dismiss}},[t("Icon",{attrs:{symbol:"remove"}})],1):e._e()],2):e._e()},gs=[],fs=a("00a1"),hs={name:"NotificationBar",components:{Icon:fs["a"]},props:{dismissable:{type:Boolean,default:!1},error:{type:Boolean,default:!1}},data(){return{active:!0}},mounted(){document.body.classList.add("with-notification")},beforeDestroy(){document.body.classList.remove("with-notification")},methods:{dismiss(){document.body.classList.remove("with-notification"),this.active=!1}}},_s=hs,Ss=(a("ca17"),Object(Ya["a"])(_s,ms,gs,!1,null,null,null)),ys=Ss.exports,Es={name:"IncompleteDomainNotificationBar",components:{NotificationBar:ys,Icon:fs["a"]},data(){return{SETTINGS_DOMAINS:p["SETTINGS_DOMAINS"]}},computed:{buttonText(){return this.$gettext("Complete your domain setup")},showButton(){return this.$route.path.indexOf("domains")<0}}},bs=Es,vs=(a("5f4c"),Object(Ya["a"])(bs,us,ps,!1,null,null,null)),Is=vs.exports,Ts=a("53a2"),ws=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("QueryModal",e._g({ref:"queryModal",scopedSlots:e._u([{key:"image",fn:function(){return[t("img",{attrs:{src:a("6b81"),alt:""}})]},proxy:!0},{key:"header",fn:function(){return[t("translate",[e._v(" Learn how to compose your emails with our essential privacy features ")])]},proxy:!0},{key:"content",fn:function(){return[t("p",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"spacing-bottom"},[e._v(" Get acquainted with alias creation, encryption, and digital signatures so you can stay in control of your treasured emails. ")]),t("button",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"button button--primary",attrs:{type:"button"},on:{click:e.showMeButtonCallback}},[e._v(" Show me ")]),t("button",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"button button--link",attrs:{type:"button"},on:{click:e.noThanksButtonCallback}},[e._v(" No thanks ")])]},proxy:!0}])},e.$listeners))},Cs=[],As=a("3abd"),Ms=s["a"].extend({name:"WelcomeComposeModal",components:{QueryModal:As["a"]},methods:{async showMeButtonCallback(){j["c"].uiEvents.create({event_type:"tutorial_welcome_compose_modal_show_me"}),await this.$router.push({name:p["MAIL_COMPOSE"],params:{startTutorial:"true"}})},noThanksButtonCallback(){j["c"].uiEvents.create({event_type:"tutorial_welcome_compose_modal_no_thanks"}),this.$refs.queryModal.closeModal()}}}),Os=Ms,Ps=Object(Ya["a"])(Os,ws,Cs,!1,null,null,null),Ns=Ps.exports,Rs=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("QueryModal",e._g({ref:"queryModal",scopedSlots:e._u([{key:"image",fn:function(){return[t("img",{attrs:{src:a("c3f9"),alt:"welcome"}})]},proxy:!0},{key:"header",fn:function(){return[t("translate",[e._v("Congratulations, your email privacy starts now!")])]},proxy:!0},{key:"content",fn:function(){return[t("p",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"spacing-bottom"},[e._v(" StartMail is secure and private. No one reads your email, but you. No ads. No tracking. Easy encryption. Ready to experience email privacy? ")]),t("p",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"spacing-bottom"},[e._v(" Start by setting up your account preferences. Use the set up guide in your inbox to assist you. ")]),t("button",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"button button--primary",attrs:{type:"button"},on:{click:e.go}},[e._v(" Go to your inbox ")])]},proxy:!0}])},e.$listeners))},xs=[],Ds=s["a"].extend({name:"WelcomeModal",components:{QueryModal:As["a"]},methods:{go(){this.$refs.queryModal.closeModal()}}}),ks=Ds,Fs=Object(Ya["a"])(ks,Rs,xs,!1,null,null,null),Ls=Fs.exports,Gs=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("DefaultDialog",e._g({attrs:{"start-open":""},scopedSlots:e._u([{key:"header",fn:function(){return[t("translate",[e._v("Set up account recovery")])]},proxy:!0}])},e.$listeners),[[t("form",{staticClass:"wrapper",attrs:{method:"dialog"}},[t("p",[t("translate",[e._v(" You don't have an account recovery email address configured, or it is not yet verified. Please go to settings and set one up. If you forget your password, we can send a recovery link to your recovery address. ")]),e._v(" "+e._s(" ")+" "),t("SupportCenterLink",{attrs:{article:"360006637377"}})],1),t("div",{staticClass:"buttons"},[t("button",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"button button--accent"},[e._v("Skip")]),t("router-link",{staticClass:"button button--primary",attrs:{to:{name:e.SETTINGS_ACCOUNT}}},[t("translate",[e._v("Go to settings")])],1)],1)])]],2)},Us=[],Bs=a("d05f"),$s=a("ac4b"),Hs=s["a"].extend({components:{DefaultDialog:Bs["a"],SupportCenterLink:$s["a"]},data(){return{SETTINGS_ACCOUNT:p["SETTINGS_ACCOUNT"]}}}),js=Hs,qs=(a("70f8"),Object(Ya["a"])(js,Gs,Us,!1,null,"2b04d7fc",null)),Vs=qs.exports,Ys=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"session-expiry-handler"},[t("Modal",{ref:"modal",attrs:{"modal-is-open":e.showReAuthenticateModal,"dialog-class":"session-expiry-handler__dialog",narrow:""},on:{modalToggled:e.resetState},scopedSlots:e._u([{key:"header",fn:function(){return[t("translate",[e._v("Your session is about to expire.")])]},proxy:!0},{key:"content",fn:function({toggle:a}){return[t("p",{staticClass:"spacing-bottom",domProps:{innerHTML:e._s(e.expiryHtml)}}),t("p",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v(" If you do nothing, you will automatically be logged out. To extend your session, enter your account password. ")]),t("form",{attrs:{novalidate:"",method:"POST",id:e.EXTEND_SESSION_EXPIRY_FORM_ID},on:{submit:function(t){return t.preventDefault(),e.extendSession.apply(null,arguments)}}},[t("fieldset",[t("legend",{staticClass:"visually-hidden"},[t("translate",[e._v("Extend session")])],1)]),t("PasswordField",{ref:"password",staticClass:"form-field",attrs:{required:"",disabled:e.loading,id:"extend-password","label-text":e.passwordText,"show-custom-validity":Boolean(e.authenticationError),"validation-error-message":e.authenticationError,"validate-input":e.validate,focused:!0,autocomplete:"current-password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),t("div",{staticClass:"modal__footer"},[t("button",{staticClass:"button button--link",attrs:{type:"button"},on:{click:a}},[t("translate",[e._v("Cancel")])],1),t("LoadingButton",{staticClass:"button button--primary",attrs:{loading:e.loading,type:"submit",form:e.EXTEND_SESSION_EXPIRY_FORM_ID}},[e._v(" "+e._s(e.submitButtonText)+" ")])],1)]}}])})],1)},Ks=[],Ws=a("7383"),zs=a("8e8d"),Qs=a("714b"),Xs=a("a747");const Js=180;var Zs=s["a"].extend({name:"SessionExpiryHandler",components:{Modal:Qs["a"],LoadingButton:zs["a"],PasswordField:Xs["a"]},data(){return{loading:!1,password:"",authenticationError:"",validate:!1,EXTEND_SESSION_EXPIRY_FORM_ID:"EXTEND_SESSION_EXPIRY_FORM_ID",componentIsMounted:!1,sessionExpiringSoon:!1,timeRemainingMinutesSeconds:this.formatSecondsToMinutes(Js),intervalId:0}},watch:{password(){this.authenticationError="",this.validate=!1}},computed:{...Object(H["e"])({isAuthenticated:e=>e.authentication.isAuthenticated,sessionTimeoutSeconds:e=>e.authentication.user.preferences.session_timeout_seconds}),...Object(H["c"])("features",["featureById"]),expiryHtml(){return this.$gettextInterpolate(this.$gettext("Your session will expire in <strong>%{ timeMinutesSeconds } minutes</strong>."),{timeMinutesSeconds:this.timeRemainingMinutesSeconds})},passwordText(){return this.$gettext("Account password")},submitButtonText(){return this.$gettext("Stay logged in")},showReAuthenticateModal(){return this.componentIsMounted&&this.isAuthenticated&&this.sessionExpiringSoon}},mounted(){this.componentIsMounted=!0,this.checkExpiry(),this.intervalId=window.setInterval(()=>{this.checkExpiry()},1e3)},destroyed(){window.clearInterval(this.intervalId)},methods:{...Object(H["b"])("authentication",["logout","getSessionExpiryAsTtl","setSessionExpiryByTtl"]),...Object(H["b"])(["setToastMessage"]),async extendSession(){if(this.loading=!0,this.validate=!0,!this.password.length)return this.authenticationError=this.$gettext("Password is required."),this.$refs.password.focus(),void(this.loading=!1);try{const e=await j["c"].authentication.extendUserSession({password:this.password});this.setSessionExpiryByTtl(e.session_ttl),this.setToastMessage({message:this.formatExtensionTimeToastMessage(this.sessionTimeoutSeconds)}),this.loading=!1,this.$refs.modal.toggleModal()}catch(e){const t=Object(Ws["a"])(e);if(t!==Ra["g"])throw this.setToastMessage({message:this.$gettext("Unable to extend user session, please try again")}),e;this.authenticationError=this.$gettext("Wrong password."),this.$refs.password.focus()}finally{this.loading=!1}},resetState(){this.password="",this.validate=!1,this.authenticationError=""},async checkExpiry(){var e;if(!this.isAuthenticated||null===(e=this.featureById(r["FEATURE_UI_SESSION_EXPIRY"]))||void 0===e||!e.enabled)return;const t=await this.getSessionExpiryAsTtl();t<=0&&(this.sessionExpiringSoon=!1,await this.logout()),t<=Js&&(this.timeRemainingMinutesSeconds=this.formatSecondsToMinutes(t),this.sessionExpiringSoon||(this.sessionExpiringSoon=!0))},formatSecondsToMinutes(e){const t=Math.floor(e/60),a=(""+e%60).padStart(2,"0");return`${t}:${a}`},formatExtensionTimeToastMessage(e){const t=e/60,a=t/60,[s,n]=t<60?[this.$ngettext("Session extended by %{ num } minute","Session extended by %{ num } minutes",t),t]:[this.$ngettext("Session extended by %{ num } hour","Session extended by %{ num } hours",a),a];return this.$gettextInterpolate(s,{num:n})}}}),en=Zs,tn=Object(Ya["a"])(en,Ys,Ks,!1,null,null,null),an=tn.exports,sn=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("NotificationBar",{staticClass:"subscription-notification-bar"},[e.isInTrial?t("translate",[e._v("Your trial period has expired")]):e.hasSubscription?t("translate",[e._v(" Subscription renewal failed ")]):e.isLastActiveMonth?t("translate",[e._v(" Your account will expire soon ")]):t("translate",[e._v("Your account has expired")]),e.$route.name!==e.SETTINGS_SUBSCRIPTION?t("RouterLink",{staticClass:"button button--accent subscription-notification-bar__button",attrs:{to:{name:e.SETTINGS_SUBSCRIPTION}}},[t("translate",[e._v("Go to subscription settings")])],1):e._e()],1)},nn=[],on=s["a"].extend({components:{NotificationBar:ys},data(){return{SETTINGS_SUBSCRIPTION:p["SETTINGS_SUBSCRIPTION"]}},computed:{isLastActiveMonth(){return this.$store.getters["authentication/isLastActiveMonth"]},hasSubscription(){return this.$store.getters["authentication/hasSubscription"]},isActive(){return this.$store.getters["authentication/isActive"]},isInTrial(){return this.$store.getters["authentication/isInTrial"]}}}),rn=on,cn=(a("c3e6"),Object(Ya["a"])(rn,sn,nn,!1,null,"44d94872",null)),ln=cn.exports,dn=a("cee4d"),un=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("Modal",e._b({on:{modalToggled:t=>e.$emit("modalToggled",t)},scopedSlots:e._u([{key:"header",fn:function(){return[t("translate",[e._v("Two-factor authentication is disabled.")])]},proxy:!0},{key:"content",fn:function({toggle:a}){return[t("p",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v(" Because you used your backup code to log in, two-factor authentication is now disabled for your account. This makes your account less secure and we recommend that you set up two-factor authentication again. Do you want to set up two-factor authentication now? ")]),t("div",{staticClass:"modal__footer"},[t("button",{staticClass:"button button--accent",attrs:{type:"button"},on:{click:a}},[t("translate",[e._v("Set up later")])],1),t("router-link",{staticClass:"button button--primary",attrs:{to:e.settingsAccountRoute}},[t("translate",[e._v("Set up")])],1)],1)]}}])},"Modal",e.$attrs,!1))},pn=[],mn=s["a"].extend({name:"TotpDisabledWarning",components:{Modal:Qs["a"]},computed:{settingsAccountRoute(){return{name:p["SETTINGS_ACCOUNT"]}}}}),gn=mn,fn=Object(Ya["a"])(gn,un,pn,!1,null,null,null),hn=fn.exports,_n=s["a"].extend({name:"App",components:{AdditionalAccountsWelcomeModal:ds,DarkMode:Wa,Error:ss,IncompleteDomainNotificationBar:Is,SessionExpiryHandler:an,SetupGuideCompletedModal:Ts["a"],SubscriptionNotificationBar:ln,ToastNotification:dn["a"],TotpDisabledWarning:hn,RecoveryReminder:Vs,WelcomeComposeModal:Ns,WelcomeModal:Ls},data(){return{titleUnwatcher:()=>{}}},computed:{...Object(H["c"])(["sidebarIsOpen","isMobileMenu"]),...Object(H["c"])("authentication",["hasIncompleteDomains","hasSubscription","isInGrace","isInQuarantine","isLastActiveMonth","isManager"]),...Object(H["e"])("authentication",["isAuthenticated","unknownError","user"]),isBodyScrollingPrevented(){return this.modalIsOpen||this.sidebarIsOpen&&this.isMobileMenu},modalIsOpen(){return Boolean(this.$route.query.modal)},modalComponent(){switch(this.$route.query.modal){case"welcome":return Ls;case"welcome-compose":return Ns;case"setup-guide-completed":return Ts["a"];case"update-recovery":return Vs;case"totp-disabled-warning":return hn;case"welcome-team-account":return ds;default:return null}},showSubscriptionBar(){return!(!this.isAuthenticated||!this.isManager)&&(!this.isInQuarantine&&(!!this.isInGrace||!(this.hasSubscription||!this.isLastActiveMonth)))},showIncompleteDomainsBar(){return this.isManager&&this.hasIncompleteDomains&&!this.isInQuarantine&&!this.$route.path.includes("signup")&&this.$route.name!==p["DELETED_USER"]&&this.$route.name!==p["SUBSCRIPTION_EXPIRED"]}},watch:{$route(e){var t;null!==(t=e.meta)&&void 0!==t&&t.title&&(this.setDocumentTitle(e.meta.title(this)),this.titleUnwatcher&&this.titleUnwatcher(),this.titleUnwatcher=this.$watch(()=>{var t;return null===(t=e.meta)||void 0===t?void 0:t.title(this)},e=>this.setDocumentTitle(e)))},isBodyScrollingPrevented(e){document.body.classList.toggle("prevent-scroll",e)}},created(){this.loadLanguage(),this.loadSidebarStatus(),this.verifyVersion(),X(this.$store)},methods:{...Object(H["b"])(["loadLanguage","loadSidebarStatus"]),setDocumentTitle(e){let t="StartMail";if(e){const a=e.charAt(0).toUpperCase()+e.slice(1),s=this.user.email?" - "+this.user.email:"";t=a+s+" - StartMail"}document.title=t},verifyVersion(){this.$root.$data.version&&this.$store.commit($t,{version:this.$root.$data.version})},async removeModalQuery(){const{modal:e,...t}=this.$route.query;await this.$router.replace({...this.$route,name:this.$route.name||void 0,query:t})}}}),Sn=_n,yn=Object(Ya["a"])(Sn,Ha,ja,!1,null,null,null),En=yn.exports,bn=a("c332"),vn=a("9483");function In(){window.caches&&window.caches.keys().then(e=>e.forEach(e=>window.caches.delete(e))).catch(e=>{if("SecurityError"!==e.name)throw e});{let e;Object(vn["a"])("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(t){console.log("Service worker has been registered."),window.clearInterval(e),e=window.setInterval(async()=>{try{await t.update()}catch(e){console.error(e),Math.random()<.001&&M["b"](e)}},36e5)},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t),window.clearInterval(e)}})}}var Tn=a("3f32"),wn=a("2f1f");In(),Object(bn["a"])(s["a"]),s["a"].use(n["a"]),n["a"].options.themes.tooltip.overflowPadding=16,s["a"].use(o.a,{availableLanguages:{en_US:"English",de_DE:"Deutsch",nl:"Nederlands"},defaultLanguage:"en_US",silent:!0,translations:wn}),s["a"].use(u),s["a"].use(C),["development","test"].includes("production")||k(s["a"]),s["a"].config.productionTip=!1,s["a"].component("FeatureToggle",Tn["a"]),new s["a"]({el:"#app",components:{App:En},data:{isDevelopment:!1,version:"5.13.0"},router:ka,store:Aa,render(e){return e("App")}}),console.log("StartMail version: 5.13.0"),console.log("%cWarning! This is a browser feature for developers. If you were asked to enter anything here, somebody might want to take over your account. Stop if you don't know what it does.","font-size: 200%; color: #f00;")},f00f:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return n}));const s="SET_SORT_ORDER",n="RESET_SORT_ORDER"},faac:function(e,t,a){},fbe7:function(e,t,a){}});
//# sourceMappingURL=app.249958fc.js.map
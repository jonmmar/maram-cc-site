try{let t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},e=(new t.Error).stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="a3c0affc-8730-4f51-a2bf-ce38d7d9323c",t._sentryDebugIdIdentifier="sentry-dbid-a3c0affc-8730-4f51-a2bf-ce38d7d9323c")}catch(e){}{let t="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:{};t.SENTRY_RELEASE={id:"5.12.0"}}(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["compose~contacts~mail"],{"07b5":function(t,e,a){"use strict";a("9d32")},"0ab4":function(t,e,a){"use strict";a("39ac")},"10db":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("Modal",t._b({ref:"modal",scopedSlots:t._u([{key:"toggle",fn:function(e){return[t._t("DeleteButton",null,{toggle:e.toggle})]}},{key:"header",fn:function(){return[t._v(" "+t._s(t.headerText||t.okButtonText+"?")+" ")]},proxy:!0},{key:"content",fn:function(a){return[t.warningText?e("p",{domProps:{textContent:t._s(t.warningText)}}):e("p",{directives:[{name:"translate",rawName:"v-translate"}]},[t._v("It is not possible to undo this action.")]),e("ModalConfirmActions",{attrs:{"is-dangerous":"","ok-text":t.okButtonText},on:{cancelClicked:a.toggle,okClicked:function(e){return t.$emit("delete")}}})]}}],null,!0)},"Modal",t.$attrs,!1))},n=[],o=a("b2fa"),i=a("714b"),r={name:"DeleteConfirmationModal",components:{Modal:i["a"],ModalConfirmActions:o["a"]},props:{warningText:{type:String,required:!1,default:""},headerText:{type:String,required:!1,default:""},okButtonText:{type:String,required:!0,default:""}},methods:{toggleModal(){this.$refs.modal.toggleModal()}}},c=r,l=a("2877"),d=Object(l["a"])(c,s,n,!1,null,null,null);e["a"]=d.exports},"1f75":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("header",{staticClass:"app-header"},[t.showBackButton?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.backButtonText,placement:"right"},expression:"{ content: backButtonText, placement: 'right' }"}],staticClass:"button app-header__back-button",attrs:{type:"button","aria-label":t.backButtonText},on:{click:function(e){return t.$emit("backClicked")}}},[e("Icon",{attrs:{symbol:"previous"}}),e("span",{staticClass:"app-header__title app-header__back-button-text"},[t._v(t._s(t.backButtonText))])],1):t.showNavigation?e("button",{directives:[{name:"test",rawName:"v-test:sidebarToggle",arg:"sidebarToggle"}],staticClass:"button app-header__icon sidebar-toggle",attrs:{type:"button","aria-label":t.toggleMenuText,title:t.toggleMenuText},on:{click:function(e){return t.$emit("toggleSidebar")}}},[e("Icon",{attrs:{symbol:"menu"}})],1):t._e(),t._t("default"),t.$scopedSlots.title?e("h1",{directives:[{name:"test",rawName:"v-test:appHeader",arg:"appHeader"}],staticClass:"app-header__title"},[t._t("title")],2):t._e(),t.$scopedSlots.button?e("div",{directives:[{name:"test",rawName:"v-test:headerButtons",arg:"headerButtons"}],staticClass:"app-header__buttons"},[t._t("button")],2):t._e(),t.$scopedSlots.navigation&&t.showNavigation?e("div",{directives:[{name:"test",rawName:"v-test:horizontalNavigation",arg:"horizontalNavigation"}],staticClass:"app-header__app-navigation sidebar-edges"},[t._t("navigation")],2):t._e()],2)},n=[],o=a("00a1"),i={components:{Icon:o["a"]},props:{showNavigation:{type:Boolean,default:!0},showBackButton:{type:Boolean,default:!1},backText:{type:String,default:""}},computed:{backButtonText(){return this.backText?this.$gettextInterpolate(this.$gettext("Back to %{ location }"),{location:this.backText},!0):this.$gettext("Back")},toggleMenuText(){return this.$gettext("Toggle menu")}}},r=i,c=(a("0ab4"),a("2877")),l=Object(c["a"])(r,s,n,!1,null,null,null);e["a"]=l.exports},"300a":function(t,e,a){"use strict";var s=a("2b0e"),n=a("2f62"),o=a("1f75"),i=a("19e2");const{...r}=o["a"].props||{};e["a"]=s["a"].component("AppHeaderWrapper",{components:{AppHeader:o["a"],AppNavigation:i["a"]},props:r,methods:{...Object(n["b"])(["toggleSidebar"])},render(t){return t(o["a"],{on:{backClicked:()=>this.$emit("backClicked"),toggleSidebar:this.toggleSidebar},props:{...this.$props},scopedSlots:{...this.$scopedSlots,navigation:()=>t(i["a"],{props:{showLabels:!0}})}})}})},3874:function(t,e,a){"use strict";var s=a("2b0e");e["a"]=s["a"].extend({data(){return{contactCategoryOptions:[{value:"home",name:this.$gettext("Home")},{value:"work",name:this.$gettext("Work")},{value:"other",name:this.$gettext("Other")}]}},methods:{getContactCategoryName(t){var e;const a=this.contactCategoryOptions.find(e=>e.value===t);return null!==(e=null===a||void 0===a?void 0:a.name)&&void 0!==e?e:""}}})},"39ac":function(t,e,a){},"9d32":function(t,e,a){},"9f81":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"search",class:{"search-toggled":t.searchToggled}},[t.desktopMode?t._e():[t.searchToggled?t._e():e("button",{directives:[{name:"test",rawName:"v-test:search",arg:"search"}],key:"toggleButton",staticClass:"button button--icon-only search__toggle",on:{click:t.showSearchField}},[e("Icon",{staticClass:"search__magnifier-icon",attrs:{symbol:"magnifier"}}),e("span",{staticClass:"visually-hidden"},[t._v(t._s(t.label))])],1)],t.desktopMode||t.searchToggled?e("InputField",{directives:[{name:"test",rawName:"v-test:search",arg:"search"}],ref:"input",attrs:{id:"search",type:"search",enterkeyhint:"search",placeholder:t.label,label:t.label,"has-hidden-label":"",autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),t.$emit("search",t.searchQuery)},blur:t.onBlur},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.abortSearch.apply(null,arguments)}},scopedSlots:t._u([{key:"prefix",fn:function(){return[e("button",{staticClass:"button button--clean button--small",attrs:{type:"submit","aria-label":t.searchButtonLabel},on:{click:function(e){return e.preventDefault(),t.$emit("search",t.searchQuery)}}},[e("Icon",{staticClass:"form-field__icon",attrs:{symbol:"magnifier"}})],1)]},proxy:!0},t.searchQuery.length>0?{key:"postfix",fn:function(){return[e("button",{staticClass:"button button--clean button--small",attrs:{type:"button","aria-label":t.clearSearchButtonLabel},on:{click:t.abortSearch}},[e("Icon",{staticClass:"search-form__remove-icon",attrs:{symbol:"remove"}})],1)]},proxy:!0}:null],null,!0),model:{value:t.searchQuery,callback:function(e){t.searchQuery=e},expression:"searchQuery"}}):t._e()],2)},n=[],o=a("00a1"),i=a("02ac"),r=a("1d41"),c=a("bd5d"),l=a("543e"),d=a("8a60"),u=a.n(d),h=a("2b0e"),p=a("2f62");const m=window.matchMedia(l["a"].SINGLE_LINE_BREAKPOINT),b=window.matchMedia(l["a"].SINGLE_LINE_BREAKPOINT);var g=h["a"].extend({name:"SearchInputField",components:{Icon:o["a"],InputField:i["a"]},props:{label:{type:String,required:!0},initialQuery:{type:String,required:!1,default:""}},data(){return{searchQuery:this.initialQuery,desktopMode:m.matches}},computed:{searchToggled(){return this.$store.state.search.searchToggled},searchMode(){return this.$route.name===r["MAIL_SEARCH"]||this.$route.name===r["CONTACTS_SEARCH"]},searchButtonLabel(){return this.$pgettext("action button","Search")},clearSearchButtonLabel(){return this.$gettext("Clear search box")}},watch:{$route(){this.matchSearchQueryToRoute()}},created(){this.searchQuery?this.showSearchInput():this.onMediaQueryChanged(b),this.$nextTick(()=>{u.a.bind("/",this.showSearchField)}),b.addEventListener?(b.addEventListener("change",this.onMediaQueryChanged),m.addEventListener("change",this.handleResize)):(b.addListener(this.onMediaQueryChanged),m.addListener(this.handleResize))},destroyed(){u.a.unbind("/"),b.removeEventListener?(b.removeEventListener("change",this.onMediaQueryChanged),m.removeEventListener("change",this.handleResize)):(b.removeListener(this.onMediaQueryChanged),m.removeListener(this.handleResize))},methods:{...Object(p["d"])({hideSearchInput:c["a"],showSearchInput:c["c"]}),showSearchField(t){null===t||void 0===t||t.preventDefault(),this.showSearchInput(),this.$nextTick(()=>{var t;null===(t=this.$refs.input)||void 0===t||t.focus()})},onBlur(){0===this.searchQuery.length&&this.hideSearchInput()},abortSearch(){var t,e;this.searchQuery.length>0?(this.searchQuery="",null===(t=this.$refs.input)||void 0===t||t.focus()):null===(e=this.$refs.input)||void 0===e||e.blur()},matchSearchQueryToRoute(){this.searchMode?(this.showSearchInput(),this.$route.query.query&&!Array.isArray(this.$route.query.query)&&(this.searchQuery=this.$route.query.query)):(this.hideSearchInput(),this.searchQuery="")},onMediaQueryChanged(t){t.matches?this.showSearchInput():this.hideSearchInput()},handleResize(t){this.desktopMode=t.matches}}}),f=g,v=(a("d71e"),a("2877")),y=Object(v["a"])(f,s,n,!1,null,null,null);e["a"]=y.exports},adef:function(t,e,a){},c0e9:function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("form",{directives:[{name:"test",rawName:"v-test:contactForm",arg:"contactForm"}],ref:"contactForm",attrs:{novalidate:""},on:{submit:function(e){return e.preventDefault(),t.onFormSubmit.apply(null,arguments)},input:t.onInput}},[e("InputField",{directives:[{name:"test",rawName:"v-test:fullName",arg:"fullName"}],attrs:{type:"text",label:t.fullNameText,icon:"user",id:"name"},model:{value:t.contactData.name,callback:function(e){t.$set(t.contactData,"name",e)},expression:"contactData.name"}}),e("div",{staticClass:"icon-wrapper"},[e("Icon",{attrs:{symbol:"unread"}}),e("transition-group",{staticClass:"email-address-list",attrs:{tag:"ul",name:"list"}},[t._l(t.contactData.email_addresses||[],(function(a,s){return e("li",{key:`${a}-${s}`,staticClass:"form-field form-field--indented"},[e("InputField",{directives:[{name:"test",rawName:"v-test:emailAddress",value:String(s),expression:"String(index)",arg:"emailAddress"}],staticClass:"value",attrs:{type:"email",label:t.emailText,placeholder:t.emailPlaceholderText,"has-hidden-label":s>0,id:"email-"+s,validate:t.formIsValidated&&Boolean(a.value),"validation-error-message":t.invalidEmailErrorMessage},model:{value:a.value,callback:function(e){t.$set(a,"value",e)},expression:"emailAddress.value"}}),e("div",{staticClass:"details"},[e("SelectInput",{staticClass:"label",attrs:{id:"label-"+s,"has-hidden-label":s>0,name:"label-"+s,label:t.emailAddressLabelText,placeholder:t.selectLabelText,options:t.contactCategoryOptions},model:{value:a.label,callback:function(e){t.$set(a,"label",e)},expression:"emailAddress.label"}}),e("label",{staticClass:"primary",attrs:{for:"primary-"+s}},[e("input",{attrs:{type:"radio",id:"primary-"+s,name:"primary-email-address"},domProps:{checked:a.is_primary},on:{change:function(e){return t.onChangePrimary(a)}}}),t._v(" "+t._s(t.emailAddressesPrimaryText)+" ")]),e("button",{staticClass:"button button--icon-only delete-button",attrs:{type:"button","aria-label":t.removeEmailAddressText,title:t.removeEmailAddressText},on:{click:function(e){return t.removeEmailAddress(s)}}},[e("Icon",{attrs:{symbol:"remove"}})],1)],1)],1)})),e("li",{key:"add",staticClass:"form-field form-field--indented"},[e("button",{directives:[{name:"test",rawName:"v-test:add-email-button",arg:"add-email-button"}],staticClass:"button",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.addEmailAddress.apply(null,arguments)}}},[e("Icon",{attrs:{symbol:"add"}}),e("translate",[t._v("Add email address")])],1)])],2)],1),e("div",{staticClass:"icon-wrapper"},[e("Icon",{attrs:{symbol:"meeting"}}),e("div",{staticClass:"form-field form-field--indented"},[e("MultiSelectInput",{attrs:{id:"contact-group",name:"contact-group",label:t.contactGroupsText,options:t.contactGroupOptions,placeholder:t.contactGroupsPlaceholder},on:{input:t.onInput},model:{value:t.contactData.contact_group_ids,callback:function(e){t.$set(t.contactData,"contact_group_ids",e)},expression:"contactData.contact_group_ids"}})],1)],1),e("InputField",{directives:[{name:"test",rawName:"v-test:phoneNumber",arg:"phoneNumber"}],staticClass:"form-field",attrs:{type:"tel",id:"phone-number",icon:"phone",label:t.phoneNumberText},model:{value:t.contactData.phone_number,callback:function(e){t.$set(t.contactData,"phone_number",e)},expression:"contactData.phone_number"}}),e("InputField",{directives:[{name:"test",rawName:"v-test:companyName",arg:"companyName"}],staticClass:"form-field",attrs:{type:"text",id:"company_name",label:t.companyNameText,icon:"company"},model:{value:t.contactData.company_name,callback:function(e){t.$set(t.contactData,"company_name",e)},expression:"contactData.company_name"}}),e("InputField",{directives:[{name:"test",rawName:"v-test:jobTitle",arg:"jobTitle"}],staticClass:"form-field",attrs:{type:"text",id:"job_title",icon:"job_title",label:t.jobTitleText},model:{value:t.contactData.job_title,callback:function(e){t.$set(t.contactData,"job_title",e)},expression:"contactData.job_title"}}),e("InputField",{directives:[{name:"test",rawName:"v-test:website",arg:"website"}],staticClass:"form-field",attrs:{type:"text",id:"website",icon:"website",label:t.websiteText,placeholder:t.websitePlaceholderText},model:{value:t.contactData.website,callback:function(e){t.$set(t.contactData,"website",e)},expression:"contactData.website"}}),e("fieldset",{staticClass:"form-field"},[e("div",{staticClass:"form-group form-group--icon"},[e("InputField",{directives:[{name:"test",rawName:"v-test:address",arg:"address"}],attrs:{type:"text",label:t.addressLineOneText,id:"address",icon:"address"},model:{value:t.contactData.address,callback:function(e){t.$set(t.contactData,"address",e)},expression:"contactData.address"}}),e("InputField",{directives:[{name:"test",rawName:"v-test:po_box",arg:"po_box"}],staticClass:"form-field form-field--indented",attrs:{type:"text",label:t.addressLineTwoText,id:"po-box"},model:{value:t.contactData.po_box,callback:function(e){t.$set(t.contactData,"po_box",e)},expression:"contactData.po_box"}}),e("div",{staticClass:"form-field--indented",attrs:{id:"address-info"}},[e("InputField",{directives:[{name:"test",rawName:"v-test:city",arg:"city"}],staticClass:"form-field",attrs:{type:"text",label:t.cityText,id:"city"},model:{value:t.contactData.city,callback:function(e){t.$set(t.contactData,"city",e)},expression:"contactData.city"}}),e("div",{staticClass:"form-group--inline-70-30 form-field"},[e("InputField",{attrs:{id:"state",type:"text",label:t.stateText},model:{value:t.contactData.state,callback:function(e){t.$set(t.contactData,"state",e)},expression:"contactData.state"}}),e("InputField",{attrs:{id:"zipCode",type:"text",label:t.zipCodeText},model:{value:t.contactData.zipcode,callback:function(e){t.$set(t.contactData,"zipcode",e)},expression:"contactData.zipcode"}})],1),e("InputField",{staticClass:"form-field",attrs:{type:"text",label:t.countryText,id:"country"},model:{value:t.contactData.country,callback:function(e){t.$set(t.contactData,"country",e)},expression:"contactData.country"}})],1)],1)]),e("div",{staticClass:"form-field icon-wrapper"},[e("Icon",{attrs:{symbol:"notepad"}}),e("TextAreaField",{staticClass:"form-field--indented",attrs:{id:"notes",label:t.notesText,rows:5,icon:"notepad"},model:{value:t.contactData.notes,callback:function(e){t.$set(t.contactData,"notes",e)},expression:"contactData.notes"}})],1),e("ModalConfirmActions",{attrs:{"ok-text":t.saveButtonText},on:{cancelClicked:t.onCancelClicked}})],1)},n=[],o=(a("14d9"),a("2b0e")),i=a("2f62"),r=a("00a1"),c=a("02ac"),l=a("b2fa"),d=a("6cef"),u=a("7b0c"),h=a("3874"),p=a("34f1"),m=a("e854"),b=o["a"].extend({components:{Icon:r["a"],InputField:c["a"],SelectInput:u["a"],MultiSelectInput:d["a"],ModalConfirmActions:l["a"],TextAreaField:m["a"]},mixins:[h["a"],p["b"]],props:{toggleModal:{type:Function,required:!0},beforeModalClose:{type:Function,required:!0},setModalLoading:{type:Function,required:!0},contact:{type:Object,required:!1,default:null}},data(){var t;let e={id:"",display_name:"",name:"",company_name:"",contact_group_ids:[],email_addresses:[],phone_number:"",job_title:"",website:"",address:"",notes:"",city:"",state:"",zipcode:"",country:"",po_box:"",always_show_external_images:!1,always_sign:!1,always_encrypt:!1,favorite:!1};if(this.contact)e={...e,...JSON.parse(JSON.stringify(this.contact))};else{const t=this.$store.state.contactGroups.activeContactGroupId,a=this.$store.getters.contactUserGroups,s=a.some(e=>e.id===t);e.contact_group_ids=s?[t]:[],e.favorite="favorites"===t}return null!==(t=e.email_addresses)&&void 0!==t&&t.length||(e.email_addresses=[{fingerprints:[],is_primary:!0,label:"home",value:""}]),{contactData:e,formIsValidated:!1,hasUnsavedChanges:!1}},computed:{contactGroupOptions(){return this.$store.getters.contactUserGroups.map(t=>({value:t.id,name:t.name}))},emailText(){return this.$gettext("Email address")},fullNameText(){return this.$gettext("Full name")},companyNameText(){return this.$gettext("Company name")},phoneNumberText(){return this.$gettext("Phone number")},selectLabelText(){return this.$gettext("Select label")},emailAddressesPrimaryText(){return this.$gettext("Primary")},cityText(){return this.$gettext("City")},stateText(){return this.$gettext("State/Province")},countryText(){return this.$gettext("Country")},emailAddressLabelText(){return this.$gettext("Label")},zipCodeText(){return this.$gettext("Zip code")},saveButtonText(){var t;return null!==(t=this.contactData)&&void 0!==t&&t.id?this.$gettext("Save contact"):this.$gettext("Add contact")},emailPlaceholderText(){return this.$gettext("e.g. someone@example.org")},websitePlaceholderText(){return this.$gettext("e.g. www.example.org")},removeEmailAddressText(){return this.$gettext("Remove this email address")},contactGroupsText(){return this.$gettext("Contact groups")},contactGroupsPlaceholder(){return this.$gettext("Select contact group")},jobTitleText(){return this.$gettext("Job title")},websiteText(){return this.$gettext("Website")},notesText(){return this.$gettext("Notes")},addressText(){return this.$gettext("Address")},addressLineOneText(){return this.$gettext("Address line 1")},addressLineTwoText(){return this.$gettext("Address line 2")},invalidEmailErrorMessage(){return this.$gettext("Incorrect email address")}},beforeCreate(){this.$store.state.contactGroupsLoaded||this.$store.dispatch("getContactGroups")},created(){this.beforeModalClose(this.onBeforeModalClose)},methods:{...Object(i["b"])(["addContact","setToastMessage","updateContact"]),onChangePrimary(t){var e;null===(e=this.contactData.email_addresses)||void 0===e||e.forEach(t=>{t.is_primary=!1}),t.is_primary=!0},onInput(){this.hasUnsavedChanges=!0},onBeforeModalClose({preventDefault:t}){this.hasUnsavedChanges&&(window.confirm(this.$gettext("You have unsaved changes. Do you want to cancel anyway?"))||t())},onFormSubmit:Object(p["a"])("saving",(async function(){if(this.contactData.email_addresses=this.contactData.email_addresses.filter(t=>t.value),this.contactData.email_addresses.length&&!this.contactData.email_addresses.some(t=>t.is_primary)&&(this.contactData.email_addresses[0].is_primary=!0),this.formIsValidated=!0,!this.$refs.contactForm.checkValidity()){const t=document.querySelector(".modal__content");return t&&t.scrollTo(0,1),!1}this.setModalLoading(!0);try{if(this.contactData.id){const t=await this.updateContact({id:this.contactData.id,contact:this.contactData});this.setToastMessage({message:this.$gettext("Contact has been updated")}),this.$emit("saved",{contact:t})}else{const t=await this.addContact({contact:this.contactData});this.setToastMessage({message:this.$gettext("Contact has been added")}),this.$emit("saved",{contact:t})}this.beforeModalClose(null),this.toggleModal()}catch(t){this.setToastMessage({message:this.$gettext("Sorry, we could not save your contact")})}finally{this.setModalLoading(!1)}})),removeEmailAddress(t){var e;null===(e=this.contactData.email_addresses)||void 0===e||e.splice(t,1)},onCancelClicked(){this.toggleModal()},addEmailAddress(){var t,e;const a=null===(t=this.contactData.email_addresses)||void 0===t?void 0:t.some(({label:t})=>"home"===t),s=null===(e=this.contactData.email_addresses)||void 0===e?void 0:e.some(({label:t})=>"work"===t),n=a?s?"other":"work":"home";this.contactData.email_addresses||(this.contactData.email_addresses=[]),this.contactData.email_addresses.push({label:n,value:"",fingerprints:[],is_primary:!1})}}}),g=b,f=(a("07b5"),a("2877")),v=Object(f["a"])(g,s,n,!1,null,"47c34734",null);e["a"]=v.exports},d71e:function(t,e,a){"use strict";a("adef")}}]);
//# sourceMappingURL=compose~contacts~mail.34f01bcd.js.map